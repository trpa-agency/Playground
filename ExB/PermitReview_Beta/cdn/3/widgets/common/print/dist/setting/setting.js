System.register(["jimu-core","jimu-arcgis","jimu-for-builder","jimu-ui","jimu-ui/advanced/setting-components","jimu-ui/basic/list-tree","jimu-for-builder/service","jimu-theme","jimu-ui/advanced/data-source-selector","jimu-ui/advanced/utility-selector","jimu-ui/advanced/style-setting-components","jimu-ui/basic/color-picker"],(function(e,t){var o={},n={},i={},r={},l={},s={},a={},u={},c={},d={},p={},m={};return{setters:[function(e){o.AllDataSourceTypes=e.AllDataSourceTypes,o.ArcGISDataSourceTypes=e.ArcGISDataSourceTypes,o.DataSourceManager=e.DataSourceManager,o.Immutable=e.Immutable,o.LayoutType=e.LayoutType,o.React=e.React,o.ReactRedux=e.ReactRedux,o.ServiceManager=e.ServiceManager,o.SessionManager=e.SessionManager,o.SupportedUtilityType=e.SupportedUtilityType,o.UtilityManager=e.UtilityManager,o.classNames=e.classNames,o.css=e.css,o.defaultMessages=e.defaultMessages,o.esri=e.esri,o.getAppStore=e.getAppStore,o.hooks=e.hooks,o.jsx=e.jsx,o.loadArcGISJSAPIModules=e.loadArcGISJSAPIModules,o.moduleLoader=e.moduleLoader,o.polished=e.polished},function(e){n.JimuMapViewComponent=e.JimuMapViewComponent},function(e){i.getAppConfigAction=e.getAppConfigAction},function(e){r.Alert=e.Alert,r.AlertPopup=e.AlertPopup,r.Button=e.Button,r.Checkbox=e.Checkbox,r.CollapsablePanel=e.CollapsablePanel,r.Dropdown=e.Dropdown,r.DropdownButton=e.DropdownButton,r.DropdownItem=e.DropdownItem,r.DropdownMenu=e.DropdownMenu,r.Icon=e.Icon,r.Loading=e.Loading,r.LoadingType=e.LoadingType,r.MultiSelect=e.MultiSelect,r.NumericInput=e.NumericInput,r.Option=e.Option,r.Radio=e.Radio,r.Select=e.Select,r.Switch=e.Switch,r.TextInput=e.TextInput,r.Tooltip=e.Tooltip,r.defaultMessages=e.defaultMessages},function(e){l.MapWidgetSelector=e.MapWidgetSelector,l.SettingRow=e.SettingRow,l.SettingSection=e.SettingSection,l.SidePopper=e.SidePopper},function(e){s.List=e.List,s.TreeItemActionType=e.TreeItemActionType},function(e){a.appServices=e.appServices},function(e){u.getTheme2=e.getTheme2,u.styled=e.styled},function(e){c.DataSourceSelector=e.DataSourceSelector},function(e){d.UtilitySelector=e.UtilitySelector},function(e){p.SizeColorSetting=e.SizeColorSetting},function(e){m.ThemeColorPicker=e.ThemeColorPicker}],execute:function(){e((()=>{var e={31027:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M12 6.5c0 .527-.074 1.036-.212 1.518l.912.438a6.5 6.5 0 1 0-6.586 4.533l-.077-1.008A5.5 5.5 0 1 1 12 6.5m-9 0a3.5 3.5 0 0 0 2.88 3.445L5.8 8.901a2.501 2.501 0 1 1 3.194-2.224l.949.456A3.5 3.5 0 1 0 3 6.5M15.5 11l-5 1-3 4-1-9.5zm-5.57.094-1.702 2.269-.542-5.152 4.76 2.38z" clip-rule="evenodd"></path></svg>'},4651:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M2 7a1 1 0 1 0 0 2 1 1 0 0 0 0-2m5 1a1 1 0 1 1 2 0 1 1 0 0 1-2 0m6 0a1 1 0 1 1 2 0 1 1 0 0 1-2 0" clip-rule="evenodd"></path></svg>'},12046:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M11.227 1.312c-.404-.404-1.045-.417-1.432-.03L2.49 8.587l-.48 2.674a.637.637 0 0 0 .73.73l2.673-.48 7.305-7.306c.387-.387.374-1.028-.03-1.431zm-8.114 9.575.32-1.781 4.991-4.992 1.462 1.462-4.992 4.991zm7.473-6.012 1.402-1.4-1.462-1.463-1.401 1.402z" clip-rule="evenodd"></path><path fill="#000" d="M1.5 14a.5.5 0 0 0 0 1h13a.5.5 0 0 0 0-1z"></path></svg>'},23662:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" d="M7.5 0a.5.5 0 0 0-.5.5V7H.5a.5.5 0 0 0 0 1H7v6.5a.5.5 0 0 0 1 0V8h6.5a.5.5 0 0 0 0-1H8V.5a.5.5 0 0 0-.5-.5"></path></svg>'},29435:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" d="M14.938 8A7 7 0 0 1 1.01 9H0a8.001 8.001 0 0 0 15.938-1A8 8 0 0 0 1.02 3.98L1 .702a.5.5 0 1 0-1 .006L.031 5.9l5.128-.826a.5.5 0 0 0-.16-.987L1.819 4.6A7 7 0 0 1 14.938 8"></path></svg>'},50170:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0m-1.27 4.936a6.5 6.5 0 1 1 .707-.707l4.136 4.137a.5.5 0 1 1-.707.707z" clip-rule="evenodd"></path></svg>'},45508:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" d="M8 5.5a1 1 0 1 0 0-2 1 1 0 0 0 0 2M6.5 7.5A.5.5 0 0 1 7 7h1.5v4.5h1a.5.5 0 0 1 0 1h-3a.5.5 0 0 1 0-1h1V8H7a.5.5 0 0 1-.5-.5"></path><path fill="#000" fill-rule="evenodd" d="M8 16A8 8 0 1 1 8 0a8 8 0 0 1 0 16m0-1A7 7 0 1 0 8 1a7 7 0 0 0 0 14" clip-rule="evenodd"></path></svg>'},28996:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M8 2.125 14.334 14H1.667zm-.882-.47a1 1 0 0 1 1.765 0l6.333 11.874A1 1 0 0 1 14.334 15H1.667a1 1 0 0 1-.882-1.47zM8 4.874a.905.905 0 0 0-.9.995l.35 3.507a.552.552 0 0 0 1.1 0L8.9 5.87a.905.905 0 0 0-.9-.995m1 7a1 1 0 1 1-2 0 1 1 0 0 1 2 0" clip-rule="evenodd"></path></svg>'},3158:e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODciIGhlaWdodD0iNjQiIHZpZXdCb3g9IjAgMCA4NyA2NCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4NCjxyZWN0IHdpZHRoPSI4NyIgaGVpZ2h0PSI2NCIgZmlsbD0iIzI4MjgyOCIvPg0KPHJlY3QgeD0iMyIgeT0iNTIiIHdpZHRoPSI4MSIgaGVpZ2h0PSI4IiByeD0iMSIgZmlsbD0iIzZBNkE2QSIvPg0KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik04NCAyNUgzVjI5SDg0VjI1Wk00MyAzN0gzVjQxSDQzVjM3WiIgZmlsbD0iIzQ0NDQ0NCIvPg0KPHJlY3QgeD0iMTQiIHk9IjUiIHdpZHRoPSIyMCIgaGVpZ2h0PSI2IiBmaWxsPSIjNkE2QTZBIi8+DQo8cmVjdCB4PSI1MyIgeT0iNSIgd2lkdGg9IjIwIiBoZWlnaHQ9IjYiIGZpbGw9IiMzNjM2MzYiLz4NCjxyZWN0IHg9IjMiIHk9IjE2IiB3aWR0aD0iODEiIGhlaWdodD0iMSIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iMyIgeT0iMTYiIHdpZHRoPSI0MCIgaGVpZ2h0PSIxIiBmaWxsPSIjNkE2QTZBIi8+DQo8L3N2Zz4NCg=="},15417:e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODciIGhlaWdodD0iNDYiIHZpZXdCb3g9IjAgMCA4NyA0NiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4NCjxyZWN0IHk9IjE2IiB3aWR0aD0iODciIGhlaWdodD0iMzAiIGZpbGw9IiMyODI4MjgiLz4NCjxyZWN0IHg9IjQiIHk9IjIzIiB3aWR0aD0iNzkiIGhlaWdodD0iNiIgZmlsbD0iIzQ0NDQ0NCIvPg0KPHJlY3QgeD0iNCIgeT0iMzgiIHdpZHRoPSI0MCIgaGVpZ2h0PSIzIiBmaWxsPSIjNDQ0NDQ0Ii8+DQo8cmVjdCB4PSI2MyIgeT0iMzYiIHdpZHRoPSIyMCIgaGVpZ2h0PSI3IiByeD0iMSIgZmlsbD0iIzZBNkE2QSIvPg0KPHJlY3Qgd2lkdGg9IjEyIiBoZWlnaHQ9IjEyIiByeD0iMiIgZmlsbD0iIzUyNTI1MiIvPg0KPC9zdmc+DQo="},62686:e=>{"use strict";e.exports=n},79244:e=>{"use strict";e.exports=o},4108:e=>{"use strict";e.exports=i},79860:e=>{"use strict";e.exports=a},1888:e=>{"use strict";e.exports=u},14321:e=>{"use strict";e.exports=r},13089:e=>{"use strict";e.exports=c},79298:e=>{"use strict";e.exports=l},15562:e=>{"use strict";e.exports=p},71371:e=>{"use strict";e.exports=d},54337:e=>{"use strict";e.exports=m},98640:e=>{"use strict";e.exports=s}},t={};function v(o){var n=t[o];if(void 0!==n)return n.exports;var i=t[o]={exports:{}};return e[o](i,i.exports,v),i.exports}v.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return v.d(t,{a:t}),t},v.d=(e,t)=>{for(var o in t)v.o(t,o)&&!v.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},v.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),v.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},v.p="";var h={};return v.p=window.jimuConfig.baseUrl,(()=>{"use strict";v.r(h),v.d(h,{__set_webpack_public_path__:()=>To,default:()=>wo});var e=v(79244),t=v(62686),o=v(4108),n=v(14321),i=v(79298);const r="CIMMarkerNorthArrow",l={color:"#000",size:"4px"};var s,a;!function(e){e.CurrentMapExtent="CURRENT MAP EXTENT",e.CurrentMapScale="CURRENT MAP SCALE",e.SetMapScale="SET MAP SCALE"}(s||(s={})),function(e){e.Point="POINT",e.Inch="INCH",e.Centimeter="CENTIMETER",e.Millimeter="MILLIMETER"}(a||(a={}));const u={layoutOptions:{customTextElements:[],hasAuthorText:!0,hasCopyrightText:!0,hasLegend:!0,hasTitleText:!0},mapSurroundInfos:[],pageSize:null,pageUnits:null,webMapFrameSize:null},c={scalePreserved:!1,outScale:36978595.474472,layoutOptions:{titleText:"ArcGIS Web Map"},exportOptions:{dpi:96},printExtentType:s.CurrentMapExtent,attributionVisible:!1,forceFeatureAttributes:!0,wkid:102100,wkidLabel:"WGS_1984_Web_Mercator_Auxiliary_Sphere",enableTitle:!0,legendEnabled:!0,enableMapPrintExtents:!0,enableOutputSpatialReference:!0,enableQuality:!0,enableFeatureAttribution:!0,enableMapSize:!0,overrideCommonSetting:!1,enableAuthor:!0,enableCopyright:!0,enableLegend:!0,enableScalebarUnit:!0,enableCustomTextElements:!0};var d,p,m,g,f,y,b,x,w;!function(e){e.LayoutTemplate="Layout Template",e.ReportTemplate="Report Template"}(d||(d={})),function(e){e.Classic="CLASSIC",e.Compact="COMPACT"}(p||(p={})),function(e){e.OrganizationService="ORGANIZATION SERVICE",e.Customize="CUSTOMIZE"}(m||(m={})),function(e){e.OrganizationTemplate="ORGANIZATION TEMPLATE",e.Customize="CUSTOMIZE"}(g||(g={})),function(e){e.Loading="LOADING",e.Success="SUCCESS",e.Error="ERROR"}(f||(f={})),function(e){e.PrintTemplate="PRINT TEMPLATE",e.PrintResult="PRINT RESULT"}(y||(y={})),function(e){e.ServiceLayout="Service Layout",e.CustomLayout="Custom Layout"}(b||(b={})),function(e){e.RPTT="RPTT",e.RPTX="RPTX"}(x||(x={})),function(e){e.ServiceReport="Service Report",e.CustomReport="Custom Report"}(w||(w={}));const T={printSource:"Source",selectMap:"Select a map widget with 2D data",printMode:"Mode",printClassic:"Classic",printCompact:"Compact",configurePrintTemplate:"Print template",printService:"Print service",useOrganizationDervice:"Use organization service",printCustomize:"Customize",printTemplate:"Print template",useOrganizationTemplate:"Use organization template",newPrintTemplate:"New print template",newTemplate:"New template",templateCommonSettings:"Template common settings",setDefaults:"Set defaults",printTitle:"Title",mapPrintingExtents:"Map printing extents",outputSpatialReference:"Output spatial reference",printQuality:"Print quality",featureAttribution:"Feature attribution",selectEditableSettings:"Select editable settings",currentMapExtent:"Current map extent",currentMapScale:"Current map scale",setMapScale:"Set map scale",useCurrentScale:"Use current scale",allowEditing:"Select settings that allow editing at runtime",wellKnownId:"Enter a well-known ID ({wkid})",includeAttribution:"Include attribution",includeLegend:"Include legend",templateConfiguration:"Template configuration",templateName:"Template name",fileFormat:"File format",printLayout:"Layout",MapOnlyOptions:"Map-only options",LayoutOptions:"Layout options",mapSize:"Map size",overrideCommonSettings:"Override common settings",overrideSettingsTitle:"Are you sure you want to disable override settings?",overrideSettingsRemind:"You will lose the settings configured.",printTemplateAuthor:"Author",copyright:"Copyright",legend:"Legend",scaleBarUnit:"Scalebar unit",miles:"Miles",kilometers:"Kilometers",meters:"Meters",feet:"Feet",mapAttribution:"Map attribution",utilityPlaceholder:"Click the \u201cSelect utility\u201d button to add utilities for further configurations.",featureAttributes:"Feature attributes",includeAttributes:"Include attributes",northArrow:"North arrow",includeNorthArrow:"Include north arrow",serviceIsNotAvailable:"Service is not available.",printPreviewStyle:"Print preview style",enablePrintPreview:"Enable print preview",useServiceLayout:"Use service layout",useCustomLayout:"Use layout from layout item",useServiceReport:"Use service report",useCustomReport:"Use report from report item",report:"Report",reportRemind:"The report can only be generated in PDF format. If you want to print the report only, please choose the MAP_ONLY layout option.",reportNotConfigured:"The report is not configured with any data.",selectLayoutItemPlaceholder:"Select an layout item",selectReportItemPlaceholder:"Select a report item",checkingReport:"Checking report",notSupportReport:"Report template is not supported.",untitledTemplate:"Untitled template"};var S=function(e,t,o,n){return new(o||(o=Promise))((function(i,r){function l(e){try{a(n.next(e))}catch(e){r(e)}}function s(e){try{a(n.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(l,s)}a((n=n.apply(e,t||[])).next())}))};const I=t=>S(void 0,void 0,void 0,(function*(){return B(t).then((t=>e.ServiceManager.getInstance().fetchArcGISServerInfo(t).then((e=>Promise.resolve(null==e?void 0:e.owningSystemUrl)),(e=>Promise.reject(e)))))})),C=(t,o,n)=>S(void 0,void 0,void 0,(function*(){const i=null==o?void 0:o.id;return i?R(i,null==t?void 0:t.useUtility,d.LayoutTemplate).then((i=>{var r,l;const s=null==i?void 0:i[0];let a=((null==t?void 0:t.printTemplateType)===g.Customize?null===(r=t.printCustomTemplate)||void 0===r?void 0:r.asMutable({deep:!0}):null===(l=t.printOrgTemplate)||void 0===l?void 0:l.asMutable({deep:!0}))[n];a.customLayoutItem=o,a=function(t,o){if(!t||!o)return o;(null==t?void 0:t.webMapFrameSize)&&(o.mapFrameSize=null==t?void 0:t.webMapFrameSize),(null==t?void 0:t.pageUnits)&&(o.mapFrameUnit=null==t?void 0:t.pageUnits);const n=null==t?void 0:t.layoutOptions,i=(0,e.Immutable)(n).without("hasAuthorText","hasCopyrightText","hasLegend","hasTitleText");o.layoutOptions=null==i?void 0:i.asMutable({deep:!0}),o=A(o,n),n&&(o.layout="");return o}(s,a);const u=Y(t,n,a);return Promise.resolve(u)}),(e=>Promise.reject(e))).catch((e=>Promise.reject(e))):Promise.reject("No custom layout item id")})),R=(e,t,o)=>S(void 0,void 0,void 0,(function*(){return B(t).then((t=>W(t,o,e)))}));function O(t,o,n,i){return S(this,void 0,void 0,(function*(){var r;let l=null===(r=$((0,e.Immutable)(o),(0,e.Immutable)(c)))||void 0===r?void 0:r.asMutable({deep:!0});l=yield function(e,t){return S(this,void 0,void 0,(function*(){var o;const{layoutChoiceList:n,defaultCustomLayoutItem:i,defaultLayout:r,supportCustomLayout:l}=null==e?void 0:e.asMutable({deep:!0});let s=b.ServiceLayout;e.layoutChoiceList&&0!==(null===(o=e.layoutChoiceList)||void 0===o?void 0:o.length)||(s=b.CustomLayout);let a={layoutTypes:s};if(l&&i){const o={defaultCustomLayoutItem:i,defaultLayout:r,supportCustomLayout:l};a=yield j(o,e.useUtility),t.customLayoutItem=(null==a?void 0:a.customLayoutItem)||null;const n=null==a?void 0:a.templateInfo;n&&(t.layoutOptions=null==n?void 0:n.layoutOptions,t.mapFrameUnit=null==n?void 0:n.pageUnits,t.mapFrameSize=null==n?void 0:n.webMapFrameSize)}else null==n||n.forEach(((e,o)=>{let n=!1;r?r===(null==e?void 0:e.layoutTemplate)&&(n=!0):0===o&&(n=!0);const i={};n&&(t=Object.assign(Object.assign({},t),e)),a.templateInfo=i}));return t.layoutTypes=null==a?void 0:a.layoutTypes,Promise.resolve(t)}))}(t,o),l=yield function(e,t){return S(this,void 0,void 0,(function*(){const{reportTemplateChoiceList:o,defaultCustomReportItem:n,defaultReportTemplate:i,supportReport:r,supportCustomReport:l}=null==e?void 0:e.asMutable({deep:!0}),s={defaultReportTemplate:i,supportCustomReport:l,defaultCustomReportItem:n,supportReport:r},a=yield E(o,s,e.useUtility);return a&&(t.reportTypes=null==a?void 0:a.reportTypes,t.customReportItem=(null==a?void 0:a.customReportItem)||null,t.report=(null==a?void 0:a.report)||null,t.reportOptions=(null==a?void 0:a.reportOptions)||null),Promise.resolve(t)}))}(t,l);const s=function(e,t){var o,n;let i=0,r=t;const l=(null==e?void 0:e.printTemplateType)===g.Customize?null===(o=e.printCustomTemplate)||void 0===o?void 0:o.asMutable({deep:!0}):null===(n=e.printOrgTemplate)||void 0===n?void 0:n.asMutable({deep:!0});return null==l||l.forEach((e=>{e.label===r&&(i+=1,r=`${t} ${i}`)})),r}(t,i);return l.format=t.defaultFormat,l.selectedFormatList=[t.defaultFormat],l.templateId=n,l.label=s,Promise.resolve(l)}))}const k=(t,o,n)=>S(void 0,void 0,void 0,(function*(){const i=D(null==o?void 0:o.utilityId);return function(t){const o={query:{f:"json"},responseType:"json"};return(0,e.loadArcGISJSAPIModules)(["esri/request"]).then((e=>{const[n]=e;return n(t,o).then((e=>function(e){return U(this,void 0,void 0,(function*(){let t=!1,o=!1;const n=(null==e?void 0:e.parameters)||[],i="web_map_as_json",r="output_file",l="layout_item_id",s="layout_template",a="report_template",u="report_item_id";let c=[],d=[],p="pdf",m=!1,v=!1,h=!1,g="",f="",y="",b="";return null==n||n.forEach((e=>{var t,o;if("Format"===e.name){const n=(null===(t=null==e?void 0:e.choiceList)||void 0===t?void 0:t.map((e=>null==e?void 0:e.toLowerCase())))||[];if(e.defaultValue)p=null===(o=e.defaultValue)||void 0===o?void 0:o.toLowerCase();else if((null==n?void 0:n.length)>0){const e=[];null==n||n.forEach((t=>{(t.include("pdf")||t.include("png"))&&e.push(t)})),p=(null==e?void 0:e[0])||n[0]}d=n}})),null==n||n.forEach((e=>{if("Layout_Template"===e.name){const t=e.choiceList,o=e.defaultValue;t?c=null==t?void 0:t.map((e=>ie(e,d,p))):c.push(ie(o,d,p))}e.name.toLowerCase()===s&&(g=(null==e?void 0:e.defaultValue)||""),e.name.toLowerCase()===l&&(m=!0,f=null==e?void 0:e.defaultValue),e.name.toLowerCase()===a&&(h=!0,y=(null==e?void 0:e.defaultValue)||""),e.name.toLowerCase()===u&&(v=!0,b=null==e?void 0:e.defaultValue),"string"==typeof e.name&&e.name.toLowerCase()===i&&(t=!0),"string"==typeof e.name&&e.name.toLowerCase()===r&&(o=!0)})),Promise.resolve({templates:c,formatList:d,defaultFormat:p,defaultReportTemplate:y,defaultCustomReportItem:b,hasWebmapParam:t,hasOutputParam:o,supportCustomLayout:m,supportReport:h,supportCustomReport:v,defaultLayout:g,defaultCustomLayoutItem:f})}))}(null==e?void 0:e.data)))}))}(t).then((e=>{let r=n;return W(t,d.LayoutTemplate).then((l=>S(void 0,void 0,void 0,(function*(){let s;if(e.supportCustomReport||e.supportReport){const n=(yield W(t,d.ReportTemplate))||[],i=N(n);r=r.set("reportTemplateChoiceList",i).set("defaultReportTemplate",null==e?void 0:e.defaultReportTemplate).set("defaultCustomReportItem",null==e?void 0:e.defaultCustomReportItem),s=yield E(n,e,o)}const a=yield j(e,o),u={templateTaskInfo:l,templatesInTask:null==e?void 0:e.templates,reportOption:s,defaultLayoutOptionInfo:a,printTemplateType:null==n?void 0:n.printTemplateType,printServiceType:i},c=P(u),p=L(null==e?void 0:e.templates,c);return r=r.set("printCustomTemplate",c).set("useUtility",o).set("formatList",null==e?void 0:e.formatList).set("defaultFormat",null==e?void 0:e.defaultFormat).set("layoutChoiceList",p).set("supportCustomLayout",e.supportCustomLayout||!1).set("supportReport",e.supportReport||!1).set("supportCustomReport",e.supportCustomReport||!1).setIn(["commonSetting","forceFeatureAttributes"],e.supportReport||e.supportCustomReport||!1),Promise.resolve(r)}))))}))})),j=(e,t)=>S(void 0,void 0,void 0,(function*(){var o;const n={layoutTypes:b.ServiceLayout};if((null==e?void 0:e.supportCustomLayout)&&(null==e?void 0:e.defaultCustomLayoutItem)){const i=yield R(null===(o=null==e?void 0:e.defaultCustomLayoutItem)||void 0===o?void 0:o.id,t,d.ReportTemplate),r=null==i?void 0:i[0];n.customLayoutItem=null==e?void 0:e.defaultCustomLayoutItem,n.templateInfo=r}return Promise.resolve(n)})),E=(e,t,o)=>S(void 0,void 0,void 0,(function*(){var n,i,r,l,s;if(!(null==t?void 0:t.supportCustomReport)||!(null==t?void 0:t.supportReport))return null;const a={reportTypes:w.ServiceReport};if((null==t?void 0:t.supportReport)&&(null==t?void 0:t.defaultReportTemplate)){let o;null==e||e.forEach((e=>{(null==e?void 0:e.reportTemplate)===(null==t?void 0:t.defaultReportTemplate)&&(o=null==e?void 0:e.reportOptions)})),a.report=null==t?void 0:t.defaultReportTemplate,a.reportOptions=o}if((null==t?void 0:t.supportCustomReport)&&(null==t?void 0:t.defaultCustomReportItem)){const e=yield R(null===(n=null==t?void 0:t.defaultCustomReportItem)||void 0===n?void 0:n.id,o,d.ReportTemplate),u=null===(i=null==e?void 0:e[0])||void 0===i?void 0:i.reportOptions;a.customReportItem={id:null===(r=null==t?void 0:t.defaultCustomReportItem)||void 0===r?void 0:r.id,title:(null===(l=null==e?void 0:e[0])||void 0===l?void 0:l.reportTemplate)||(null===(s=null==t?void 0:t.defaultCustomReportItem)||void 0===s?void 0:s.id)},a.reportOptions=u,a.reportTypes=w.CustomReport}return Promise.resolve(a)})),N=e=>{if(!e)return[];return e.filter((e=>Q(null==e?void 0:e.reportOptions)===x.RPTX))},A=(e,t)=>{var o,n;if(!t)return e;const i=null===(o=null==t?void 0:t.customTextElements)||void 0===o?void 0:o.map((e=>{const t={};for(const o in e)t[o]=!0;return t})),r=M(t);return e.hasAuthorText=null==t?void 0:t.hasAuthorText,e.hasCopyrightText=null==t?void 0:t.hasCopyrightText,e.hasLegend=null==t?void 0:t.hasLegend,e.hasTitleText=null==t?void 0:t.hasTitleText,e.layoutOptions.customTextElements=(null==t?void 0:t.customTextElements)||[],e.layoutOptions.elementOverrides=r,e.customTextElementEnableList=i||[],e.enableNorthArrow=!!J(r),e.enableLegend=e.hasLegend,e.enableAuthor=e.hasAuthorText,e.enableCopyright=e.hasCopyrightText,e.enableScalebarUnit=!0,e.hasLegend&&(null==e?void 0:e.layoutOptions)&&(e.layoutOptions.legendLayers=[]),(null===(n=e.layoutOptions)||void 0===n?void 0:n.scalebarUnit)||(e.layoutOptions.scalebarUnit="Miles"),e},P=e=>{const{templateTaskInfo:t,templatesInTask:o,reportOption:n,defaultLayoutOptionInfo:i,printServiceType:r,printTemplateType:l}=e,s=o?oe(o,r,l):[],a=null==s?void 0:s.map((e=>{var o;let r;if(t&&0!==(null==t?void 0:t.length)?t.forEach((t=>{e.label===t.layoutTemplate&&(r=t)})):r=u,(null==e?void 0:e.layout)&&(e.layout=q(null==e?void 0:e.layout)),(null==e?void 0:e.format)&&(e.format=null===(o=null==e?void 0:e.format)||void 0===o?void 0:o.toLowerCase()),(null==r?void 0:r.webMapFrameSize)&&(e.mapFrameSize=null==r?void 0:r.webMapFrameSize,e.mapFrameUnit=null==r?void 0:r.pageUnits),(e=A(e,null==r?void 0:r.layoutOptions)).mapFrameUnit=null==r?void 0:r.pageUnits,e.selectedFormatList=[null==e?void 0:e.format],n&&((null==n?void 0:n.customReportItem)&&(e.customReportItem=null==n?void 0:n.customReportItem),(null==n?void 0:n.report)&&(e.report=null==n?void 0:n.report),(null==n?void 0:n.reportOptions)&&(e.reportOptions=null==n?void 0:n.reportOptions),(null==n?void 0:n.reportTypes)&&(e.reportTypes=null==n?void 0:n.reportTypes)),i){(null==i?void 0:i.layoutTypes)&&(e.layoutTypes=null==i?void 0:i.layoutTypes),(null==i?void 0:i.customLayoutItem)&&(e.customLayoutItem=null==i?void 0:i.customLayoutItem);const t=null==i?void 0:i.templateInfo;t&&((null==t?void 0:t.layoutOptions)&&(e.layoutOptions=null==t?void 0:t.layoutOptions),(null==t?void 0:t.pageUnits)&&(e.mapFrameUnit=null==t?void 0:t.pageUnits),(null==t?void 0:t.webMapFrameSize)&&(e.mapFrameSize=null==t?void 0:t.webMapFrameSize))}return e}));return a},M=e=>{const t=(null==e?void 0:e.mapSurroundInfos)||[],o={};return null==t||t.forEach((e=>{e.type===`${r}`&&(e.visible=!0),o[e.name]=e})),o},L=(e,t)=>{const o=(null==e?void 0:e.map((e=>{e.layoutTemplate=q(null==e?void 0:e.layout);const o=H(null==e?void 0:e.layout);return null==t||t.forEach((t=>{(null==e?void 0:e.layout)===(null==t?void 0:t.layout)&&(e.mapFrameSize=null==t?void 0:t.mapFrameSize,e.mapFrameUnit=null==t?void 0:t.mapFrameUnit,e.hasAuthorText=null==t?void 0:t.hasAuthorText,e.hasCopyrightText=null==t?void 0:t.hasCopyrightText,e.hasLegend=null==t?void 0:t.hasLegend,e.hasTitleText=null==t?void 0:t.hasTitleText,!o&&(e.layoutOptions=null==t?void 0:t.layoutOptions),e.customTextElementEnableList=null==t?void 0:t.customTextElementEnableList,e.enableNorthArrow=t.enableNorthArrow,e.enableLegend=t.hasLegend,e.enableAuthor=t.hasAuthorText,e.enableCopyright=t.hasCopyrightText,e.enableScalebarUnit=!0,e.enableNorthArrow=null==t?void 0:t.enableNorthArrow)})),e})))||[];return o},D=t=>{const o=e.UtilityManager.getInstance().getUtilityJson(t);return"org"===(null==o?void 0:o.source)?m.OrganizationService:m.Customize};var _,U=function(e,t,o,n){return new(o||(o=Promise))((function(i,r){function l(e){try{a(n.next(e))}catch(e){r(e)}}function s(e){try{a(n.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(l,s)}a((n=n.apply(e,t||[])).next())}))};!function(e){e.AsynchronousSubmit="esriExecutionTypeAsynchronous",e.SynchronousExecute="esriExecutionTypeSynchronous"}(_||(_={}));const z=(e,t)=>e===m.Customize||t===g.Customize?"custom":"org",$=(t,o)=>{let n=o;return(null==t?void 0:t.exportOptions)&&(n=n.set("exportOptions",Object.assign(Object.assign({},t.exportOptions||{}),(null==o?void 0:o.exportOptions)||{}))),(null==t?void 0:t.layoutOptions)&&(null==o?void 0:o.layoutOptions)&&(n=n.set("layoutOptions",Object.assign(Object.assign({},(null==t?void 0:t.layoutOptions)||{}),(null==o?void 0:o.layoutOptions)||{}))),(0,e.Immutable)(Object.assign(Object.assign({},t),n))},G=(e,t)=>{let o;return null==e||e.forEach(((e,n)=>{(null==e?void 0:e.templateId)===t&&(o=n)})),o},F=(e,t)=>e===m.Customize||t===g.Customize,q=e=>e,H=e=>"map-only"===(e=>{var t,o;return null===(o=null===(t=null==e?void 0:e.replace(/\_/gi,"-"))||void 0===t?void 0:t.replace(/\s+/gi,"-"))||void 0===o?void 0:o.toLowerCase()})(e),B=t=>U(void 0,void 0,void 0,(function*(){return e.UtilityManager.getInstance().getUrlOfUseUtility(t).then((e=>Promise.resolve(e)))}));function W(t,o,n){return U(this,void 0,void 0,(function*(){const i={query:{"env:outSR":"","env:processSR":"",returnZ:!1,returnM:!1,returnTrueCurves:!1,returnFeatureCollection:!1,context:"",f:"json"},responseType:"json"},r=yield(l=t,S(void 0,void 0,void 0,(function*(){return e.ServiceManager.getInstance().fetchArcGISServerInfo(l).then((e=>Promise.resolve(null==e?void 0:e.owningSystemUrl)),(e=>Promise.reject(e)))})));var l;const s=r?e.SessionManager.getInstance().getSessionByUrl(r):null;if(n){const e={id:n};s&&(e.token=s.token),o===d.LayoutTemplate&&(s&&(i.query.token=s.token),i.query.Layout_Item_ID=JSON.stringify(e)),o===d.ReportTemplate&&(i.query.Report_Item_ID=JSON.stringify(e))}return function(t){return U(this,void 0,void 0,(function*(){var o;if(!t)return Promise.resolve(null);const n=`${null===(o=t.split("/GPServer"))||void 0===o?void 0:o[0]}/GPServer`,i=function(){var t,o;const n=(null===(t=(0,e.getAppStore)().getState().portalSelf)||void 0===t?void 0:t.helperServices)||{};return(null===(o=null==n?void 0:n.asyncPrintTask)||void 0===o?void 0:o.url)||null}(),r=(yield V(n))||{},{tasks:l,supportedOperations:s,executionType:a}=r;let u=a,c=null,d=null,p=null,m=null;if(null==l||l.forEach((e=>{((null==e?void 0:e.includes("Layout"))||(null==e?void 0:e.includes("Layout")))&&(c=`${n}/${e}`,d=`${c}/${s}`),((null==e?void 0:e.includes("Report"))||(null==e?void 0:e.includes("report")))&&(p=`${n}/${e}`,m=`${n}/${e}/${s}`)})),i===t){const e=yield function(e){return U(this,void 0,void 0,(function*(){const t=`${null==e?void 0:e.split("/arcgis/")[0]}/arcgis/rest/services/Utilities/PrintingTools/GPServer`,o=(yield V(t))||{},{tasks:n,supportedOperations:i,executionType:r}=o;let l=null,s=null,a=null;return null==n||n.forEach((e=>{((null==e?void 0:e.includes("Layout"))||(null==e?void 0:e.includes("Layout")))&&(a=e)})),l=`${t}/${a}`,s=`${l}/${i}`,{layoutTemplatesInfoTaskUrl:l,layoutTemplatesInfoRequestUrl:s,executionType:r}}))}(n);c=e.layoutTemplatesInfoTaskUrl,d=e.layoutTemplatesInfoRequestUrl,u=e.executionType}return Promise.resolve({url:n,layoutTemplatesInfoTaskUrl:c,layoutTemplatesInfoRequestUrl:d,reportTemplatesInfoTaskUrl:p,reportTemplatesInfoRequestUrl:m,executionType:a,layoutTemplateTaskExecutionType:u})}))}(t).then((t=>{const{layoutTemplatesInfoRequestUrl:n,reportTemplatesInfoRequestUrl:r,reportTemplatesInfoTaskUrl:l,executionType:s,layoutTemplatesInfoTaskUrl:a,layoutTemplateTaskExecutionType:u}=t,c=o===d.ReportTemplate?r:n,p=o===d.LayoutTemplate?u:s;return c?(0,e.loadArcGISJSAPIModules)(["esri/request"]).then((e=>{const[t]=e;return t(c,i).then((e=>U(this,void 0,void 0,(function*(){var n,r,s;if(p===_.AsynchronousSubmit){const r=null===(n=null==e?void 0:e.data)||void 0===n?void 0:n.jobId;return function(e,t,o,n){return U(this,void 0,void 0,(function*(){const i=`${e}/jobs/${t}/results/Output_JSON`;return new Promise(((e,t)=>{let r=0;const l=10,s=3e3,a=()=>{n(i,o).then((t=>{var o;(null===(o=null==t?void 0:t.data)||void 0===o?void 0:o.value)?e(t.data.value):(r++,r<l?setTimeout(a,s):e([]))})).catch((e=>{t(e)}))};a()}))}))}(o===d.ReportTemplate?l:a,r,i,t)}return Promise.resolve((null===(s=null===(r=null==e?void 0:e.data)||void 0===r?void 0:r.results[0])||void 0===s?void 0:s.value)||[])}))),(e=>Promise.reject(e))).catch((e=>Promise.reject(e)))})):Promise.resolve(null)}))}))}function V(t){return U(this,void 0,void 0,(function*(){var o;if(!t)return Promise.resolve(null);const n=`${null===(o=t.split("/GPServer"))||void 0===o?void 0:o[0]}/GPServer`,i={query:{f:"json"},responseType:"json"};return(0,e.loadArcGISJSAPIModules)(["esri/request"]).then((e=>{const[t]=e;return t(n,i).then((e=>{var t,o;const n=null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.tasks,i=null===(o=null==e?void 0:e.data)||void 0===o?void 0:o.executionType,r=i===_.SynchronousExecute?"execute":"submitJob";return Promise.resolve({tasks:n,supportedOperations:r,executionType:i})}))}))}))}function Z(t){return U(this,void 0,void 0,(function*(){return(0,e.loadArcGISJSAPIModules)(["esri/rest/support/LegendLayer"]).then((e=>{var o,n,i;const[r]=e,l=K((null===(i=null===(n=null===(o=null==t?void 0:t.view)||void 0===o?void 0:o.map)||void 0===n?void 0:n.layers)||void 0===i?void 0:i.toArray())||[],r);return Promise.resolve(l)}))}))}function K(e,t){if(!e)return[];let o=[];return null==e||e.forEach((e=>{var n,i,r;const l=(null==e?void 0:e.effect)&&(null==e?void 0:e.effect.length)>0,s="binning"===(null===(n=null==e?void 0:e.featureReduction)||void 0===n?void 0:n.type),a="pie-chart"===(null===(i=null==e?void 0:e.renderer)||void 0===i?void 0:i.type);if("graphics"!==e.type&&e.visible&&(null==e?void 0:e.legendEnabled)&&!l&&!s&&!a){const n=(null==e?void 0:e.subLayerIds)||null;if("group"===(null==e?void 0:e.type)){const n=K((null===(r=null==e?void 0:e.layers)||void 0===r?void 0:r._items)||[],t)||[];o=o.concat(n)}const i=new t({layerId:null==e?void 0:e.id,title:null==e?void 0:e.title,subLayerIds:n});o.push(i)}})),o}function J(e={}){var t;let o=null;for(const n in e)(null===(t=null==e?void 0:e[n])||void 0===t?void 0:t.type)===r&&(o=n);return o}function Q(e){if(!e)return null;let t=x.RPTX;const o=(null==e?void 0:e.reportSectionOverrides)||{};return Object.keys(o).forEach((e=>{const n=o[e];((null==n?void 0:n.fieldElements)||(null==n?void 0:n.fieldLabelElements))&&(t=x.RPTT)})),t}function Y(e,t,o){var n,i;const r=(null==e?void 0:e.printTemplateType)===g.Customize?null===(n=e.printCustomTemplate)||void 0===n?void 0:n.asMutable({deep:!0}):null===(i=e.printOrgTemplate)||void 0===i?void 0:i.asMutable({deep:!0});r[t]=o;return(null==e?void 0:e.printTemplateType)===g.Customize?e.set("printCustomTemplate",r):e.set("printOrgTemplate",r)}function X(e){const{reportOptions:t,defaultCustomReportItem:o,defaultReportTemplate:n,supportCustomReport:i,supportReport:r,reportTypes:l}=e;if(!i&&!r)return!0;switch(l){case w.CustomReport:return t?ee(t):!o&&!n;case w.ServiceReport:return t?ee(t):!n}}function ee(e){if(!(null==e?void 0:e.reportSectionOverrides))return!1;const t=(null==e?void 0:e.reportSectionOverrides)||{};let o=!0;return Object.keys(t).forEach(((e,n)=>{var i,r;const l=t[e];if((null==l?void 0:l.exbDatasource)&&0!==(null===(i=null==l?void 0:l.exbDatasource)||void 0===i?void 0:i.length)){const e=te()||[],t=null===(r=null==l?void 0:l.exbDatasource)||void 0===r?void 0:r[0],n=(null==t?void 0:t.rootDataSourceId)||(null==t?void 0:t.mainDataSourceId);(null==e?void 0:e.includes(n))||(o=!1)}else o=!1})),o}const te=()=>{var t;const o=(0,e.getAppStore)().getState(),n=(null==o?void 0:o.appStateInBuilder)?null===(t=null==o?void 0:o.appStateInBuilder)||void 0===t?void 0:t.appConfig:null==o?void 0:o.appConfig,i=null==n?void 0:n.dataSources,r=[];return Object.keys(i).forEach((t=>{const o=i[t];(null==o?void 0:o.type)!==e.ArcGISDataSourceTypes.WebScene&&r.push(o.id)})),r.length>0?(0,e.Immutable)(r):void 0},oe=(t,o,n)=>{const i=t.map((t=>{var o;let n=(0,e.Immutable)(t);return n=n.set("layout",q(null==t?void 0:t.layout)),n=n.setIn(["layoutOptions","scalebarUnit"],"Miles").setIn(["layoutOptions","legendLayers"],null),n=n.set("reportTypes",w.ServiceReport).set("layoutTypes",b.ServiceLayout),H(null==n?void 0:n.layout)&&(n=n.set("exportOptions",Object.assign({width:800,height:1100},null==t?void 0:t.exportOptions))),null===(o=$((0,e.Immutable)(c),(0,e.Immutable)(n)))||void 0===o?void 0:o.asMutable({deep:!0})}));return ne(i,o,n)},ne=(e,t,o)=>{const n=z(t,o);return e.map(((e,t)=>(e.templateId=`config_${n}_${t}`,e)))};function ie(e,t,o){const n=H(e)?{}:{layoutOptions:{legend:!1}},i=o||t[0]||"PNG32";return Object.assign({label:e,layout:e,format:i},n)}var re=v(98640);const le=(e,t,o)=>{const n=e.map((e=>e.templateId)),i=z(t,o);if(!n||0===(null==n?void 0:n.length))return`config_${i}_0`;return`config_${i}_${se(n)+1}`},se=e=>{var t;const o=null==e?void 0:e.map((e=>{var t;const o=null===(t=null==e?void 0:e.split("_"))||void 0===t?void 0:t.pop();return o?Number(o):0}));return null===(t=null==o?void 0:o.sort(((e,t)=>t-e)))||void 0===t?void 0:t[0]};const ae=(t,o,n)=>{var i,r;const l=null===(i=null==n?void 0:n.filter((e=>(null==e?void 0:e.layout)===o)))||void 0===i?void 0:i[0];let s=Object.assign(Object.assign(Object.assign({},t),l),{layoutTypes:b.ServiceLayout});return H(null==l?void 0:l.layout)&&(s=null===(r=(0,e.Immutable)(s).setIn(["exportOptions","width"],800).setIn(["exportOptions","height"],1100))||void 0===r?void 0:r.asMutable({deep:!0})),s};function ue(e,t){if(t){const t={reportTemplate:"None"};e.unshift(t)}return e}var ce=v(4651),de=v.n(ce),pe=function(e,t){var o={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(o[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(o[n[i]]=e[n[i]])}return o};const me=t=>{const o=window.SVG,{className:n}=t,i=pe(t,["className"]),r=(0,e.classNames)("jimu-icon jimu-icon-component",n);return o?e.React.createElement(o,Object.assign({className:r,src:de()},i)):e.React.createElement("svg",Object.assign({className:r},i))},ve=e.css`
  .report-remind-alert .jimu-icon-component {
    color: var(--sys-color-warning-main) !important;
  }
`,he=t=>{const o=e.hooks.useTranslation(n.defaultMessages),{config:i,templateList:r,itemStateDetailContent:l,activeTemplateId:s,handelActiveTemplateIdChange:a,handelTemplateListChange:u}=t,[c,d]=e.React.useState(!1),p=e.hooks.useEventCallback((e=>{let t=0;const o=n=>(e=>r.some((t=>t.label===e)))(n)?(t+=1,o(n=`${e} ${t}`)):n;return o(e)})),m=e=>{d(!c),e.stopPropagation()};return(0,e.jsx)("div",{className:"d-flex align-items-center",css:ve},!(e=>{const{defaultCustomReportItem:t,defaultReportTemplate:o,supportCustomReport:n,supportReport:r}=i;return X({defaultCustomReportItem:t,defaultReportTemplate:o,supportCustomReport:n,supportReport:r,reportOptions:null==e?void 0:e.reportOptions,reportTypes:null==e?void 0:e.reportTypes})})(l)&&(0,e.jsx)(n.Alert,{className:"report-remind-alert",buttonType:"tertiary",form:"tooltip",size:"small",type:"warning",text:o("reportTemplateRemind")}),(0,e.jsx)(n.Dropdown,{direction:"down",size:"sm",useKeyUpEvent:!0,toggle:m,isOpen:c},(0,e.jsx)(n.DropdownButton,{size:"sm",arrow:!1,icon:!0,onClick:m,type:"tertiary",title:o("more")},(0,e.jsx)(me,{size:"s"})),(0,e.jsx)(n.DropdownMenu,null,(0,e.jsx)(n.DropdownItem,{title:o("duplicate"),onClick:e=>{e.stopPropagation();const t=G(r,s),o=le(r,i.printServiceType,i.printTemplateType),n=r,l=p(r[t].label),c=Object.assign(Object.assign({},r[t]),{templateId:o,label:l});n.push(c),u(n),setTimeout((()=>{a(o)}),200)}},o("duplicate")),(0,e.jsx)(n.DropdownItem,{title:o("deleteOption"),onClick:()=>{const e=G(r,s),t=r;null==t||t.splice(e,1),u(t),a(null)}},o("deleteOption")))))},ge=e.css`
  .report-remind-alert {
    .jimu-icon-component {
      color: var(--sys-color-warning-main) !important;
    }
    &.jimu-btn {
      padding: 0 !important;
    }
  }
`,fe=t=>{const{className:o,config:n,activeTemplateId:i,showNewTemplateItem:r,handelActiveTemplateIdChange:l,handelTemplateListChange:s}=t,a={overrideItemBlockInfo:({itemBlockInfo:e},t)=>({name:re.TreeItemActionType.RenderOverrideItem,children:[{name:re.TreeItemActionType.RenderOverrideItemDroppableContainer,children:[{name:re.TreeItemActionType.RenderOverrideItemDraggableContainer,children:[{name:re.TreeItemActionType.RenderOverrideItemBody,children:[{name:re.TreeItemActionType.RenderOverrideItemMainLine,children:[{name:re.TreeItemActionType.RenderOverrideItemDragHandle},{name:re.TreeItemActionType.RenderOverrideItemIcon,autoCollapsed:!0},{name:re.TreeItemActionType.RenderOverrideItemTitle},{name:re.TreeItemActionType.RenderOverrideItemDetailToggle},{name:re.TreeItemActionType.RenderOverrideItemCommands}]}]}]}]}]})};e.React.useEffect((()=>{c((null==n?void 0:n.printTemplateType)===g.Customize||(null==n?void 0:n.printServiceType)===m.Customize),v()}),[n]);const[u,c]=e.React.useState((null==n?void 0:n.printTemplateType)===g.Customize||(null==n?void 0:n.printServiceType)===m.Customize),[d,p]=e.React.useState([]),v=()=>{var e,t;(null==n?void 0:n.printServiceType)===m.Customize||(null==n?void 0:n.printTemplateType)===g.Customize?p((null===(e=null==n?void 0:n.printCustomTemplate)||void 0===e?void 0:e.asMutable({deep:!0}))||[]):p((null===(t=null==n?void 0:n.printOrgTemplate)||void 0===t?void 0:t.asMutable({deep:!0}))||[])};return(0,e.jsx)("div",{className:`w-100 mt-2 ${o||""}`,css:ge},(0,e.jsx)(re.List,Object.assign({className:"w-100",itemsJson:Array.from(d).map(((e,t)=>({itemStateDetailContent:e,itemKey:`${null==e?void 0:e.templateId}`,itemStateChecked:i&&(null==e?void 0:e.templateId)===i,itemStateTitle:null==e?void 0:e.label,itemStateIcon:null,itemStateCommands:[]}))),dndEnabled:u,renderOverrideItemDetailToggle:(t,o)=>{const{itemJsons:i}=o.props,[r]=i,a=null==r?void 0:r.itemStateDetailContent,u=null==r?void 0:r.itemKey;return(0,e.jsx)(he,{activeTemplateId:u,itemStateDetailContent:a,templateList:d,config:n,handelActiveTemplateIdChange:l,handelTemplateListChange:s})},onUpdateItem:(e,t)=>{const{itemJsons:o}=t.props,[,n]=o;if(e.updateType===re.TreeItemActionType.HandleDidDrop){const e=n.map((e=>e.itemStateDetailContent));l(null),s(e)}},onClickItemBody:(e,t)=>{const{itemJsons:o}=t.props,n=o[0],i=o[1];l(n.itemKey,i.indexOf(n))}},a)),r&&(0,e.jsx)(re.List,Object.assign({className:"setting-ui-unit-list-new",itemsJson:[{name:"......"}].map(((e,t)=>({itemStateDetailContent:"item",itemKey:"index",itemStateChecked:!0,itemStateTitle:"......",itemStateCommands:[]}))),dndEnabled:!1,renderOverrideItemDetailToggle:()=>""},a)))};var ye=v(23662),be=v.n(ye),xe=function(e,t){var o={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(o[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(o[n[i]]=e[n[i]])}return o};const we=t=>{const o=window.SVG,{className:n}=t,i=xe(t,["className"]),r=(0,e.classNames)("jimu-icon jimu-icon-component",n);return o?e.React.createElement(o,Object.assign({className:r,src:be()},i)):e.React.createElement("svg",Object.assign({className:r},i))};var Te=v(29435),Se=v.n(Te),Ie=function(e,t){var o={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(o[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(o[n[i]]=e[n[i]])}return o};const Ce=t=>{const o=window.SVG,{className:n}=t,i=Ie(t,["className"]),r=(0,e.classNames)("jimu-icon jimu-icon-component",n);return o?e.React.createElement(o,Object.assign({className:r,src:Se()},i)):e.React.createElement("svg",Object.assign({className:r},i))};var Re=function(e,t,o,n){return new(o||(o=Promise))((function(i,r){function l(e){try{a(n.next(e))}catch(e){r(e)}}function s(e){try{a(n.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(l,s)}a((n=n.apply(e,t||[])).next())}))};const Oe=v(12046),ke=new(0,e.esri.Sanitizer),{useRef:je}=e.React;var Ee;!function(e){e.Title="TITLE",e.Extents="EXTENTS",e.SpatialReference="SPATIAL REFERENCE",e.Feature="FEATURE ATTRIBUTION",e.Quality="QUALITY"}(Ee||(Ee={}));const Ne=t=>{var o,r;const l=e.hooks.useTranslation(T,e.defaultMessages,n.defaultMessages),a=e.React.useRef(null),u=je(null),c=je(!1),d=e.css`
    .dpi-input .input-wrapper{
      padding-right: 0;
    }
    .radio-con {
      cursor: ponter;
    }
    .use-current-map-scale svg{
      margin: 0 auto;
    }
    .enable-setting-con .jimu-widget-setting--row-label{
      margin-bottom: 0;
    }
    .wkid-describtion {
      font-size: ${e.polished.rem(12)};
      color: var(--ref-palette-neutral-900);
    }
    .wkid-describtion-invalid {
      color: var(--sys-color-error-dark)
    }
    .check-box-con, .radio-con {
      color: var(--ref-palette-neutral-900);
      font-size: ${e.polished.rem(14)};
      line-height: ${e.polished.rem(22)};
      margin: ${e.polished.rem(4)} 0 ${e.polished.rem(8)} 0;
    }
  `,{printTemplateProperties:m,modeType:v,jimuMapView:h,handleTemplatePropertyChange:g}=t,[f,y]=e.React.useState(null),[b,x]=e.React.useState((null===(o=m.layoutOptions)||void 0===o?void 0:o.titleText)||""),[w,S]=e.React.useState(null==m?void 0:m.wkid),[I,C]=e.React.useState(null===(r=null==m?void 0:m.exportOptions)||void 0===r?void 0:r.dpi),[R,O]=e.React.useState(null==m?void 0:m.outScale),[k,j]=e.React.useState(null);e.React.useEffect((()=>{var e,t;x((null===(e=m.layoutOptions)||void 0===e?void 0:e.titleText)||""),S(null==m?void 0:m.wkid),a.current=null==m?void 0:m.wkid,C(null===(t=null==m?void 0:m.exportOptions)||void 0===t?void 0:t.dpi),O(null==m?void 0:m.outScale),(null==m?void 0:m.wkidLabel)?j(null==m?void 0:m.wkidLabel):u.current&&E(null==m?void 0:m.wkid).then((e=>{j(e)}))}),[m]);const E=t=>Re(void 0,void 0,void 0,(function*(){if(c.current){const{getSRLabel:e}=u.current;return Promise.resolve(e(t))}return e.moduleLoader.loadModule("jimu-core/wkid").then((e=>{u.current=e,c.current=!0;const{getSRLabel:o}=u.current;return Promise.resolve(o(t))}))})),N=t=>Re(void 0,void 0,void 0,(function*(){if(c.current){const{isValidWkid:e}=u.current;return Promise.resolve(e(t))}return e.moduleLoader.loadModule("jimu-core/wkid").then((e=>{u.current=e,c.current=!0;const{isValidWkid:o}=u.current;return Promise.resolve(o(t))}))})),A=e=>Re(void 0,void 0,void 0,(function*(){if(e===Ee.SpatialReference&&!(null==m?void 0:m.wkidLabel)){const e=yield E(null==m?void 0:m.wkid);j(e)}y(e)})),P=()=>{y(null)},M=e=>{var t;let o=m.setIn(["printExtentType"],e);const n=h?null===(t=null==h?void 0:h.view)||void 0===t?void 0:t.scale:36978595.474472;switch(e){case s.CurrentMapExtent:o=o.setIn(["scalePreserved"],!1);break;case s.CurrentMapScale:o=o.setIn(["scalePreserved"],!0);break;case s.SetMapScale:o=o.setIn(["scalePreserved"],!0),o=o.setIn(["outScale"],n)}g(o)},L=e=>{const t=m.setIn([e],!(null==m?void 0:m[e]));g(t)};return(0,e.jsx)("div",{css:d},(0,e.jsx)("div",{role:"group","aria-label":l("setDefaults")},(0,e.jsx)(i.SettingRow,{label:l("setDefaults"),flow:"wrap"}),(0,e.jsx)(n.CollapsablePanel,{label:l("printTitle"),isOpen:f===Ee.Title,onRequestOpen:()=>{A(Ee.Title)},onRequestClose:P,role:"group","aria-label":l("printTitle"),rightIcon:Oe,type:"primary",className:f===Ee.Title&&"active-collapse"},(0,e.jsx)(i.SettingRow,{className:"mt-2"},(0,e.jsx)(n.TextInput,{size:"sm",className:"search-placeholder w-100",placeholder:l("printTitle"),value:b,onAcceptValue:e=>{const t=m.setIn(["layoutOptions","titleText"],e);g(t)},onChange:e=>{var t;const o=null===(t=null==e?void 0:e.target)||void 0===t?void 0:t.value;x(o)},"aria-label":l("printTitle")}))),(0,e.jsx)(n.CollapsablePanel,{label:l("mapPrintingExtents"),isOpen:f===Ee.Extents,onRequestOpen:()=>{A(Ee.Extents)},onRequestClose:P,role:"group","aria-label":l("mapPrintingExtents"),rightIcon:Oe,type:"primary",className:f===Ee.Extents&&"active-collapse"},(0,e.jsx)(i.SettingRow,{className:"mt-2"},(0,e.jsx)("div",{className:"w-100"},(0,e.jsx)("div",{title:l("currentMapExtent"),"aria-label":l("currentMapExtent"),className:"d-flex align-items-center radio-con",onClick:()=>{M(s.CurrentMapExtent)}},(0,e.jsx)(n.Radio,{title:l("currentMapExtent"),checked:(null==m?void 0:m.printExtentType)===s.CurrentMapExtent,className:"mr-2"})," ",l("currentMapExtent")),(0,e.jsx)("div",{title:l("currentMapScale"),"aria-label":l("currentMapScale"),className:"d-flex align-items-center radio-con",onClick:()=>{M(s.CurrentMapScale)}},(0,e.jsx)(n.Radio,{title:l("currentMapScale"),checked:(null==m?void 0:m.printExtentType)===s.CurrentMapScale,className:"mr-2"})," ",l("currentMapScale")),(0,e.jsx)("div",{title:l("setMapScale"),"aria-label":l("setMapScale"),className:"d-flex align-items-center radio-con",onClick:()=>{M(s.SetMapScale)}},(0,e.jsx)(n.Radio,{title:l("setMapScale"),checked:(null==m?void 0:m.printExtentType)===s.SetMapScale,className:"mr-2"})," ",l("setMapScale")),(null==m?void 0:m.printExtentType)===s.SetMapScale&&(0,e.jsx)("div",{className:"d-flex mt-1 align-items-center"},(0,e.jsx)(n.NumericInput,{size:"sm",className:"search-placeholder flex-grow-1 dpi-input",value:R,onAcceptValue:e=>{const t=m.setIn(["outScale"],e);g(t)},onChange:e=>{O(e)},showHandlers:!1}),(0,e.jsx)(n.Button,{className:"use-current-map-scale",size:"sm",title:l("useCurrentScale"),disabled:!h,onClick:()=>{var e;if(!h)return;const t=null===(e=null==h?void 0:h.view)||void 0===e?void 0:e.scale,o=m.setIn(["outScale"],t);g(o)}},(0,e.jsx)(Ce,null)))))),(0,e.jsx)(n.CollapsablePanel,{label:l("outputSpatialReference"),isOpen:f===Ee.SpatialReference,onRequestOpen:()=>{A(Ee.SpatialReference)},onRequestClose:P,role:"group",type:"primary","aria-label":l("outputSpatialReference"),rightIcon:Oe,className:f===Ee.SpatialReference&&"active-collapse"},(0,e.jsx)(i.SettingRow,{flow:"wrap",label:(0,e.jsx)("div",{className:"flex-grow-1",dangerouslySetInnerHTML:{__html:ke.sanitize(l("wellKnownId",{wkid:'<a target="_blank" href="https://developers.arcgis.com/rest/services-reference/enterprise/using-spatial-references.htm">WKID</a>'}))}}),className:"mt-2"},(0,e.jsx)(n.NumericInput,{size:"sm",className:"search-placeholder w-100",value:w,onAcceptValue:e=>Re(void 0,void 0,void 0,(function*(){if(!(yield N(e))){S(a.current);const t=yield E(e);return j(t),!1}a.current=e;const t=m.setIn(["wkid"],e).set("wkidLabel",k);g(t);const o=yield E(e);j(o)})),onChange:e=>Re(void 0,void 0,void 0,(function*(){S(e);if(yield N(e)){const t=yield E(e);j(t)}else j(l("invalidWKID"))})),showHandlers:!1,"aria-label":l("wellKnownId",{wkid:"WKID"}),"aria-describedby":"print-wkid-describtion"}),(0,e.jsx)("div",{id:"print-wkid-describtion",className:(0,e.classNames)("text-truncate mt-1 wkid-describtion",{"wkid-describtion-invalid":!(e=>{if(u.current){const{isValidWkid:t}=u.current;return t(e)}return!0})(Number(w))}),title:k,"aria-label":k},k))),(0,e.jsx)(n.CollapsablePanel,{label:l("printQuality"),isOpen:f===Ee.Quality,onRequestOpen:()=>{A(Ee.Quality)},onRequestClose:P,role:"group","aria-label":l("printQuality"),type:"primary",rightIcon:Oe,className:f===Ee.Quality&&"active-collapse"},(0,e.jsx)(i.SettingRow,{className:"mt-2"},(0,e.jsx)("div",{className:"d-flex align-items-center w-100"},(0,e.jsx)(n.NumericInput,{size:"sm",className:"search-placeholder flex-grow-1 dpi-input",placeholder:l("printQuality"),value:I,onAcceptValue:e=>{if(e<1)return!1;const t=m.setIn(["exportOptions","dpi"],parseInt(e));g(t)},onChange:e=>{if(e<1)return!1;C(parseInt(e))},showHandlers:!1,"aria-label":l("printQuality")}),(0,e.jsx)(n.Button,{disabled:!0,size:"sm",title:"DPI"},"DPI")))),(0,e.jsx)(n.CollapsablePanel,{label:l("featureAttributes"),isOpen:f===Ee.Feature,onRequestOpen:()=>{A(Ee.Feature)},onRequestClose:P,role:"group",type:"primary","aria-label":l("featureAttributes"),rightIcon:Oe,className:f===Ee.Feature&&"active-collapse"},(0,e.jsx)(i.SettingRow,{className:"mt-2"},(0,e.jsx)("div",{title:l("includeAttributes"),className:"d-flex w-100 align-items-center check-box-con","aria-label":l("includeAttributes"),onClick:()=>{L("forceFeatureAttributes")}},(0,e.jsx)(n.Checkbox,{title:l("includeAttributes"),className:"lock-item-ratio","data-field":"forceFeatureAttributes",checked:(null==m?void 0:m.forceFeatureAttributes)||!1}),(0,e.jsx)("div",{className:"lock-item-ratio-label text-left ml-2"},l("includeAttributes")))))),v===p.Classic&&(0,e.jsx)(i.SettingRow,{className:"mt-4 enable-setting-con",flow:"wrap",role:"group","aria-label":l("selectEditableSettings"),label:l("selectEditableSettings")},(0,e.jsx)("div",{className:"w-100"},(0,e.jsx)("div",{title:l("printTitle"),className:"d-flex w-100 align-items-center check-box-con",onClick:()=>{(()=>{let e=m.setIn(["showLabels"],!(null==m?void 0:m.showLabels));e=e.setIn(["enableTitle"],!(null==m?void 0:m.enableTitle)),g(e)})()}},(0,e.jsx)(n.Checkbox,{title:l("printTitle"),className:"lock-item-ratio","data-field":"enableTitle",checked:(null==m?void 0:m.enableTitle)||!1}),(0,e.jsx)("div",{className:"lock-item-ratio-label text-left ml-2"},l("printTitle"))),(0,e.jsx)("div",{title:l("mapPrintingExtents"),className:"d-flex w-100 align-items-center check-box-con",onClick:()=>{L("enableMapPrintExtents")}},(0,e.jsx)(n.Checkbox,{title:l("mapPrintingExtents"),className:"lock-item-ratio","data-field":"enableMapPrintExtents",checked:(null==m?void 0:m.enableMapPrintExtents)||!1}),(0,e.jsx)("div",{className:"lock-item-ratio-label text-left ml-2"},l("mapPrintingExtents"))),(0,e.jsx)("div",{title:l("outputSpatialReference"),className:"d-flex w-100 align-items-center check-box-con",onClick:()=>{L("enableOutputSpatialReference")}},(0,e.jsx)(n.Checkbox,{title:l("outputSpatialReference"),className:"lock-item-ratio","data-field":"enableOutputSpatialReference",checked:(null==m?void 0:m.enableOutputSpatialReference)||!1}),(0,e.jsx)("div",{className:"lock-item-ratio-label text-left ml-2"},l("outputSpatialReference"))),(0,e.jsx)("div",{title:l("printQuality"),className:"d-flex w-100 align-items-center check-box-con",onClick:()=>{L("enableQuality")}},(0,e.jsx)(n.Checkbox,{title:l("printQuality"),className:"lock-item-ratio","data-field":"enableQuality",checked:(null==m?void 0:m.enableQuality)||!1}),(0,e.jsx)("div",{className:"lock-item-ratio-label text-left ml-2"},l("printQuality"))),(0,e.jsx)("div",{title:l("featureAttributes"),className:"d-flex w-100 align-items-center check-box-con",onClick:()=>{L("enableFeatureAttribution")}},(0,e.jsx)(n.Checkbox,{title:l("featureAttributes"),className:"lock-item-ratio","data-field":"enableFeatureAttribution",checked:(null==m?void 0:m.enableFeatureAttribution)||!1}),(0,e.jsx)("div",{className:"lock-item-ratio-label text-left ml-2"},l("featureAttributes"))))))};var Ae=v(50170),Pe=v.n(Ae),Me=function(e,t){var o={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(o[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(o[n[i]]=e[n[i]])}return o};const Le=t=>{const o=window.SVG,{className:n}=t,i=Me(t,["className"]),r=(0,e.classNames)("jimu-icon jimu-icon-component",n);return o?e.React.createElement(o,Object.assign({className:r,src:Pe()},i)):e.React.createElement("svg",Object.assign({className:r},i))};function De(e){return Object.keys(e).some((t=>{let o=e[t];if(!o)return!1;o&&o.toParam&&(o=o.toParam());switch(o.constructor.name){case"Array":case"Object":case"Date":case"Function":case"Boolean":case"String":case"Number":return!1;default:return!0}}))}function _e(e){const t={};return Object.keys(e).forEach((o=>{var n,i;let r=e[o];if(r&&r.toParam&&(r=r.toParam()),!r&&0!==r&&"boolean"!=typeof r&&"string"!=typeof r)return;let l;switch(r.constructor.name){case"Array":const e=null===(i=null===(n=r[0])||void 0===n?void 0:n.constructor)||void 0===i?void 0:i.name;l="Array"===e?r:"Object"===e?JSON.stringify(r):r.join(",");break;case"Object":l=JSON.stringify(r);break;case"Date":l=r.valueOf();break;case"Function":l=null;break;case"Boolean":l=r+"";break;default:l=r}(l||0===l||"string"==typeof l||Array.isArray(l))&&(t[o]=l)})),t}function Ue(e,t){return Array.isArray(t)&&t[0]&&Array.isArray(t[0])?t.map((t=>Ue(e,t))).join("&"):encodeURIComponent(e)+"="+encodeURIComponent(t)}function ze(e){const t=_e(e);return Object.keys(t).map((e=>Ue(e,t[e]))).join("&")}const $e=globalThis.FormData;globalThis.File,globalThis.Blob;class Ge extends Error{constructor(e,t,o,n,i){super(e);const r=new.target.prototype;Object.setPrototypeOf(this,r),e=e||"UNKNOWN_ERROR",t=t||"UNKNOWN_ERROR_CODE",this.name="ArcGISRequestError",this.message="UNKNOWN_ERROR_CODE"===t?e:`${t}: ${e}`,this.originalMessage=e,this.code=t,this.response=o,this.url=n,this.options=i}}function Fe(e){console&&console.warn&&console.warn.apply(console,[e])}const qe="@esri/arcgis-rest-js";class He extends Ge{constructor(e="AUTHENTICATION_ERROR",t="AUTHENTICATION_ERROR_CODE",o,n,i){super(e,t,o,n,i),this.name="ArcGISAuthError",this.message="AUTHENTICATION_ERROR_CODE"===t?e:`${t}: ${e}`;const r=new.target.prototype;Object.setPrototypeOf(this,r)}retry(e,t=1){let o=0;const n=(i,r)=>{o+=1,e(this.url,this.options).then((e=>{const t=Object.assign(Object.assign({},this.options),{authentication:e});return Be(this.url,t)})).then((e=>{i(e)})).catch((e=>{"ArcGISAuthError"===e.name&&o<t?n(i,r):e.name===this.name&&e.message===this.message&&o>=t?r(this):r(e)}))};return new Promise(((e,t)=>{n(e,t)}))}}function Be(e,t){const o=globalThis.DEFAULT_ARCGIS_REQUEST_OPTIONS||{httpMethod:"POST",params:{f:"json"}},n=Object.assign(Object.assign(Object.assign({httpMethod:"POST"},o),t),{params:Object.assign(Object.assign({},o.params),t.params),headers:Object.assign(Object.assign({},o.headers),t.headers)}),{httpMethod:i,rawResponse:r}=n,l=Object.assign({f:"json"},n.params);let s=null;const a={method:i,signal:n.signal,credentials:n.credentials||"same-origin"};let u;if(n.headers&&n.headers["X-Esri-Auth-Client-Id"]&&e.indexOf("/oauth2/platformSelf")>-1&&(a.credentials="include"),"string"==typeof n.authentication){const e=n.authentication;u={portal:"https://www.arcgis.com/sharing/rest",getToken:()=>Promise.resolve(e)},n.authentication.startsWith("AAPK")||n.suppressWarnings||globalThis.ARCGIS_REST_JS_SUPPRESS_TOKEN_WARNING||(Fe("Using an oAuth 2.0 access token directly in the token option is discouraged. Consider using ArcGISIdentityManager or Application session. See https://esriurl.com/arcgis-rest-js-direct-token-warning for more information."),globalThis.ARCGIS_REST_JS_SUPPRESS_TOKEN_WARNING=!0)}else u=n.authentication;const c=e;return(u?u.getToken(e).catch((t=>(t.url=e,t.options=n,s=t,Promise.resolve("")))):Promise.resolve("")).then((t=>{t.length&&(l.token=t),u&&u.getDomainCredentials&&(a.credentials=u.getDomainCredentials(e));const o={};if("GET"===a.method){l.token&&n.hideToken&&"undefined"==typeof window&&(o["X-Esri-Authorization"]=`Bearer ${l.token}`,delete l.token);const i=""===ze(l)?e:e+"?"+ze(l);n.maxUrlLength&&i.length>n.maxUrlLength||l.token&&n.hideToken?(a.method="POST",t.length&&n.hideToken&&(l.token=t,delete o["X-Esri-Authorization"])):e=i}const i=new RegExp("/items/.+/updateResources").test(e);return"POST"===a.method&&(a.body=function(e,t){const o=De(e)||t,n=_e(e);if(o){const e=new $e;return Object.keys(n).forEach((t=>{if("undefined"!=typeof Blob&&n[t]instanceof Blob){const o=n.fileName||n[t].name||t;e.append(t,n[t],o)}else e.append(t,n[t])})),e}return ze(e)}(l,i)),a.headers=Object.assign(Object.assign({},o),n.headers),("undefined"==typeof window||window&&void 0===window.document)&&!a.headers.referer&&(a.headers.referer=qe),De(l)||i||(a.headers["Content-Type"]="application/x-www-form-urlencoded"),globalThis.fetch?globalThis.fetch(e,a):Promise.resolve({fetch:globalThis.fetch,Headers:globalThis.Headers,Response:globalThis.Response,Request:globalThis.Request}).then((({fetch:t})=>t(e,a)))})).then((t=>{if(!t.ok)return t.json().then((o=>{const{status:i,statusText:r}=t,{message:l,details:s}=o.error,a=`${l}. ${s?s.join(" "):""}`.trim();throw new Ge(a,`HTTP ${i} ${r}`,o,e,n)})).catch((o=>{if("ArcGISRequestError"===o.name)throw o;const{status:i,statusText:r}=t;throw new Ge(r,`HTTP ${i}`,t,e,n)}));if(r)return t;switch(l.f){case"json":case"geojson":return t.json();case"html":case"text":return t.text();default:return t.blob()}})).then((t=>{if("json"!==l.f&&"geojson"!==l.f||r)return t;{const o=function(e,t,o,n,i){if(e.code>=400){const{message:o,code:i}=e;throw new Ge(o,i,e,t,n)}if(e.error){const{message:o,code:r,messageCode:l}=e.error,s=l||r||"UNKNOWN_ERROR_CODE";if(498===r||499===r)throw i||new He(o,s,e,t,n);throw new Ge(o,s,e,t,n)}if("failed"===e.status||"failure"===e.status){let o,i="UNKNOWN_ERROR_CODE";try{o=JSON.parse(e.statusMessage).message,i=JSON.parse(e.statusMessage).code}catch(t){o=e.statusMessage||e.message}throw new Ge(o,i,e,t,n)}return e}(t,c,0,n,s);if(s){const t=e.toLowerCase().split(/\/rest(\/admin)?\/services\//)[0];n.authentication.federatedServers[t]={token:[],expires:new Date(Date.now()+864e5)},s=null}return o}}))}function We(e,t={params:{f:"json"}}){return Be(e,t).catch((e=>e instanceof He&&t.authentication&&"string"!=typeof t.authentication&&t.authentication.canRefresh&&t.authentication.refreshCredentials?e.retry((()=>t.authentication.refreshCredentials()),1):Promise.reject(e)))}var Ve,Ze;!function(e){e.TOKEN_REFRESH_FAILED="TOKEN_REFRESH_FAILED",e.GENERATE_TOKEN_FOR_SERVER_FAILED="GENERATE_TOKEN_FOR_SERVER_FAILED",e.REFRESH_TOKEN_EXCHANGE_FAILED="REFRESH_TOKEN_EXCHANGE_FAILED",e.NOT_FEDERATED="NOT_FEDERATED",e.UNKNOWN_ERROR_CODE="UNKNOWN_ERROR_CODE"}(Ve||(Ve={}));class Ke extends Error{constructor(e="UNKNOWN_ERROR",t=Ve.UNKNOWN_ERROR_CODE,o,n,i){super(e);const r=new.target.prototype;Object.setPrototypeOf(this,r),this.name="ArcGISTokenRequestError",this.message=`${t}: ${e}`,this.originalMessage=e,this.code=t,this.response=o,this.url=n,this.options=i}}class Je extends Error{constructor(){super("The user has denied your authorization request.");const e=new.target.prototype;Object.setPrototypeOf(this,e),this.name="ArcGISAccessDeniedError"}}Error;function Qe(e){return"string"!=typeof e||"/"===(e=e.trim())[e.length-1]&&(e=e.slice(0,-1)),e}!function(e){e.ArcGISRequestError="ArcGISRequestError",e.ArcGISAuthError="ArcGISAuthError",e.ArcGISAccessDeniedError="ArcGISAccessDeniedError",e.ArcGISTokenRequestError="ArcGISTokenRequestError"}(Ze||(Ze={}));const Ye=3e5;function Xe(e,t){const o=t;return o.rawResponse=!1,We(e,o).then((e=>{if("token"in e&&"expires"in e)return{token:e.token,username:t.params.username,expires:new Date(e.expires)};const o={token:e.access_token,username:e.username,expires:new Date(Date.now()+1e3*e.expires_in-Ye),ssl:!0===e.ssl};return e.refresh_token&&(o.refreshToken=e.refresh_token),e.refresh_token_expires_in&&(o.refreshTokenExpires=new Date(Date.now()+1e3*e.refresh_token_expires_in-Ye)),o}))}function et(e){return!e||e.length<=0?{}:e.replace(/^#/,"").replace(/^\?/,"").split("&").reduce(((e,t)=>{const{key:o,value:n}=function(e){const[t,o]=e.split("=");return{key:decodeURIComponent(t),value:decodeURIComponent(o)}}(t);return e[o]=n,e}),{})}const tt=/^https?:\/\/(\S+)\.arcgis\.com.+/;function ot(e){return tt.test(e)}function nt(e){if(!tt.test(e))return null;const t=e.match(tt)[1].split(".").pop();return t.includes("dev")?"dev":t.includes("qa")?"qa":"production"}function it(e,t){const o=Qe(function(e){if(!tt.test(e))return e;switch(nt(e)){case"dev":return"https://devext.arcgis.com/sharing/rest";case"qa":return"https://qaext.arcgis.com/sharing/rest";default:return"https://www.arcgis.com/sharing/rest"}}(t)).replace(/https?:\/\//,""),n=Qe(e).replace(/https?:\/\//,"");return new RegExp(n,"i").test(o)}function rt(e,t=window){return!t&&window&&(t=window),t.btoa(String.fromCharCode.apply(null,e)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}function lt(e){!e&&window&&(e=window);return rt(e.crypto.getRandomValues(new Uint8Array(32)))}class st{constructor(e){if(this.clientId=e.clientId,this._refreshToken=e.refreshToken,this._refreshTokenExpires=e.refreshTokenExpires,this._username=e.username,this.password=e.password,this._token=e.token,this._tokenExpires=e.tokenExpires,this.portal=e.portal?Qe(e.portal):"https://www.arcgis.com/sharing/rest",this.ssl=e.ssl,this.provider=e.provider||"arcgis",this.tokenDuration=e.tokenDuration||20160,this.redirectUri=e.redirectUri,this.server=e.server,this.referer=e.referer,this.federatedServers={},this.trustedDomains=[],e.server){const t=this.getServerRootUrl(e.server);this.federatedServers[t]={token:e.token,expires:e.tokenExpires}}this._pendingTokenRequests={}}get token(){return this._token}get tokenExpires(){return this._tokenExpires}get refreshToken(){return this._refreshToken}get refreshTokenExpires(){return this._refreshTokenExpires}get username(){return this._username?this._username:this._user&&this._user.username?this._user.username:void 0}get canRefresh(){return!(!this.username||!this.password)||!!(this.clientId&&this.refreshToken&&this.redirectUri)}static beginOAuth2(e,t){!t&&window&&(t=window);const{portal:o,provider:n,clientId:i,expiration:r,redirectUri:l,popup:s,popupWindowFeatures:a,locale:u,params:c,style:d,pkce:p,state:m}=Object.assign({portal:"https://www.arcgis.com/sharing/rest",provider:"arcgis",expiration:20160,popup:!0,popupWindowFeatures:"height=400,width=600,menubar=no,location=yes,resizable=yes,scrollbars=yes,status=yes",locale:"",style:"",pkce:!0},e),v=m||lt(t),h=`ARCGIS_REST_JS_AUTH_STATE_${i}`;t.localStorage.setItem(h,v);let g=`${Qe(o)}/oauth2/authorize`;const f={client_id:i,response_type:p?"code":"token",expiration:r,redirect_uri:l,state:JSON.stringify({id:v,originalUrl:t.location.href}),locale:u,style:d};let y;if("arcgis"!==n&&(g=`${Qe(o)}/oauth2/social/authorize`,f.socialLoginProviderName=n,f.autoAccountCreateForSocial=!0),p){const e=lt(t),o=`ARCGIS_REST_JS_CODE_VERIFIER_${i}`;t.localStorage.setItem(o,e),y=function(e,t=window){if(!t&&window&&(t=window),e&&t.isSecureContext&&t.crypto&&t.crypto.subtle){const o=(new t.TextEncoder).encode(e);return t.crypto.subtle.digest("SHA-256",o).then((e=>rt(new Uint8Array(e),t)))}return Promise.resolve(null)}(e,t).then((function(t){f.code_challenge_method=t?"S256":"plain",f.code_challenge=t||e}))}else y=Promise.resolve();return y.then((()=>(g=`${g}?${ze(f)}`,c&&(g=`${g}&${ze(c)}`),s?new Promise(((e,n)=>{t.addEventListener(`arcgis-rest-js-popup-auth-${i}`,(t=>{if("access_denied"===t.detail.error){const e=new Je;return n(e),e}if(t.detail.errorMessage){const e=new He(t.detail.errorMessage,t.detail.error);return n(e),e}e(new st({clientId:i,portal:o,ssl:t.detail.ssl,token:t.detail.token,tokenExpires:t.detail.expires,username:t.detail.username,refreshToken:t.detail.refreshToken,refreshTokenExpires:t.detail.refreshTokenExpires,redirectUri:l}))}),{once:!0}),t.open(g,"oauth-window",a),t.dispatchEvent(new CustomEvent("arcgis-rest-js-popup-auth-start"))})):void(t.location.href=g))))}static completeOAuth2(e,t){!t&&window&&(t=window);const{portal:o,clientId:n,popup:i,pkce:r,redirectUri:l}=Object.assign({portal:"https://www.arcgis.com/sharing/rest",popup:!0,pkce:!0},e),s=`ARCGIS_REST_JS_AUTH_STATE_${n}`,a=t.localStorage.getItem(s),u=et(r?t.location.search.replace(/^\?/,""):t.location.hash.replace(/^#/,"")),c=u&&u.state?JSON.parse(u.state):void 0;function d(e,o,r){return t.localStorage.removeItem(s),i&&t.opener?(t.opener.dispatchEvent(new CustomEvent(`arcgis-rest-js-popup-auth-${n}`,{detail:{error:o,errorMessage:e}})),void t.close()):(r&&t.history.replaceState(t.history.state,"",r),"access_denied"===o?Promise.reject(new Je):Promise.reject(new He(e,o)))}function p(e,r){return t.localStorage.removeItem(s),i&&t.opener?(t.opener.dispatchEvent(new CustomEvent(`arcgis-rest-js-popup-auth-${n}`,{detail:Object.assign({},e)})),void t.close()):(t.history.replaceState(t.history.state,"",r),new st({clientId:n,portal:o,ssl:e.ssl,token:e.token,tokenExpires:e.expires,username:e.username,refreshToken:e.refreshToken,refreshTokenExpires:e.refreshTokenExpires,redirectUri:l||location.href.replace(location.search,"")}))}if(!a||!c)return d("No authentication state was found, call `ArcGISIdentityManager.beginOAuth2(...)` to start the authentication process.","no-auth-state");if(c.id!==a)return d("Saved client state did not match server sent state.","mismatched-auth-state");if(u.error){const e=u.error;return d(u.error_description||"Unknown error",e,c.originalUrl)}if(r&&u.code){const e=Qe(`${o}/oauth2/token/`),i=`ARCGIS_REST_JS_CODE_VERIFIER_${n}`,r=t.localStorage.getItem(i);return t.localStorage.removeItem(i),Xe(e,{httpMethod:"POST",params:{client_id:n,code_verifier:r,grant_type:"authorization_code",redirect_uri:l||location.href.replace(location.search,""),code:u.code}}).then((e=>p(Object.assign(Object.assign({},e),c),c.originalUrl))).catch((e=>d(e.originalMessage,e.code,c.originalUrl)))}return!r&&u.access_token?Promise.resolve(p(Object.assign({token:u.access_token,expires:new Date(Date.now()+1e3*parseInt(u.expires_in,10)),ssl:"true"===u.ssl,username:u.username},c),c.originalUrl)):d("Unknown error","oauth-error",c.originalUrl)}static fromParent(e,t){let o;return!t&&window&&(t=window),new Promise(((n,i)=>{o=e=>{if(e.source===t.parent&&e.data)try{return n(st.parentMessageHandler(e))}catch(e){return i(e)}},t.addEventListener("message",o,!1),t.parent.postMessage({type:"arcgis:auth:requestCredential"},e)})).then((e=>(t.removeEventListener("message",o,!1),e)))}static authorize(e,t){const{portal:o,clientId:n,expiration:i,redirectUri:r,state:l}=Object.assign({portal:"https://arcgis.com/sharing/rest",expiration:20160},e),s={client_id:n,expiration:i,response_type:"code",redirect_uri:r};l&&(s.state=l);const a=`${o}/oauth2/authorize?${ze(s)}`;t.writeHead(301,{Location:a}),t.end()}static exchangeAuthorizationCode(e,t){const{portal:o,clientId:n,redirectUri:i}=Object.assign({portal:"https://www.arcgis.com/sharing/rest"},e);return Xe(`${o}/oauth2/token`,{params:{grant_type:"authorization_code",client_id:n,redirect_uri:i,code:t}}).then((e=>new st({clientId:n,portal:o,ssl:e.ssl,redirectUri:i,refreshToken:e.refreshToken,refreshTokenExpires:e.refreshTokenExpires,token:e.token,tokenExpires:e.expires,username:e.username}))).catch((e=>{throw new Ke(e.message,Ve.REFRESH_TOKEN_EXCHANGE_FAILED,e.response,e.url,e.options)}))}static deserialize(e){const t=JSON.parse(e);return new st({clientId:t.clientId,refreshToken:t.refreshToken,refreshTokenExpires:t.refreshTokenExpires?new Date(t.refreshTokenExpires):void 0,username:t.username,password:t.password,token:t.token,tokenExpires:t.tokenExpires?new Date(t.tokenExpires):void 0,portal:t.portal,ssl:t.ssl,tokenDuration:t.tokenDuration,redirectUri:t.redirectUri,server:t.server})}static fromCredential(e,t){const o=void 0===e.ssl||e.ssl,n=e.expires||Date.now()+72e5;return t.hasServer?new st({server:e.server,ssl:o,token:e.token,username:e.userId,tokenExpires:new Date(n)}):new st({portal:Qe(e.server.includes("sharing/rest")?e.server:e.server+"/sharing/rest"),ssl:o,token:e.token,username:e.userId,tokenExpires:new Date(n)})}static parentMessageHandler(e){if("arcgis:auth:credential"===e.data.type)return new st(e.data.credential);if("arcgis:auth:error"===e.data.type){const t=new Error(e.data.error.message);throw t.name=e.data.error.name,t}throw new Error("Unknown message type.")}static destroy(e){return function(e){const t=`${Qe(e.portal||"https://www.arcgis.com/sharing/rest")}/oauth2/revokeToken/`,o=e.token,n=e.clientId;delete e.portal,delete e.clientId,delete e.token;const i=Object.assign(Object.assign({},e),{httpMethod:"POST",params:{client_id:n,auth_token:o}});return We(t,i).then((e=>{if(!e.success)throw new Ge("Unable to revoke token",500,e,t,i);return e}))}({clientId:e.clientId,portal:e.portal,token:e.refreshToken||e.token})}static fromToken(e){const t=new st(e);return t.getUser().then((()=>t))}static signIn(e){const t=new st(e);return t.getUser().then((()=>t))}toCredential(){return{expires:this.tokenExpires.getTime(),server:this.server||this.portal,ssl:this.ssl,token:this.token,userId:this.username}}getUser(e){if(this._pendingUserRequest)return this._pendingUserRequest;if(this._user)return Promise.resolve(this._user);{const t=`${this.portal}/community/self`,o=Object.assign(Object.assign({httpMethod:"GET",authentication:this},e),{rawResponse:!1});return this._pendingUserRequest=We(t,o).then((e=>(this._user=e,this._pendingUserRequest=null,e))),this._pendingUserRequest}}getPortal(e){if(this._pendingPortalRequest)return this._pendingPortalRequest;if(this._portalInfo)return Promise.resolve(this._portalInfo);{const t=`${this.portal}/portals/self`,o=Object.assign(Object.assign({httpMethod:"GET",authentication:this},e),{rawResponse:!1});return this._pendingPortalRequest=We(t,o).then((e=>(this._portalInfo=e,this._pendingPortalRequest=null,e))),this._pendingPortalRequest}}getUsername(){return this.username?Promise.resolve(this.username):this.getUser().then((e=>e.username))}getToken(e,t){return function(e,t){const o=ot(e),n=ot(t),i=nt(e),r=nt(t);return!(!o||!n||i!==r)}(this.portal,e)||new RegExp(this.portal,"i").test(e)?this.getFreshToken(t):this.getTokenForServer(e,t)}validateAppAccess(e){return this.getToken(this.portal).then((t=>function(e,t,o="https://www.arcgis.com/sharing/rest"){return We(`${o}/oauth2/validateAppAccess`,{method:"POST",params:{f:"json",client_id:t,token:e}})}(t,e)))}toJSON(){return{clientId:this.clientId,refreshToken:this.refreshToken,refreshTokenExpires:this.refreshTokenExpires||void 0,username:this.username,password:this.password,token:this.token,tokenExpires:this.tokenExpires||void 0,portal:this.portal,ssl:this.ssl,tokenDuration:this.tokenDuration,redirectUri:this.redirectUri,server:this.server}}serialize(){return JSON.stringify(this)}enablePostMessageAuth(e,t){!t&&window&&(t=window),this._hostHandler=this.createPostMessageHandler(e),t.addEventListener("message",this._hostHandler,!1)}disablePostMessageAuth(e){!e&&window&&(e=window),e.removeEventListener("message",this._hostHandler,!1)}refreshCredentials(e){return this._user=null,this.username&&this.password?this.refreshWithUsernameAndPassword(e):this.clientId&&this.refreshToken?this.refreshWithRefreshToken():Promise.reject(new Ke("Unable to refresh token. No refresh token or password present.",Ve.TOKEN_REFRESH_FAILED))}getServerRootUrl(e){const[t]=Qe(e).split(/\/rest(\/admin)?\/services(?:\/|#|\?|$)/),[o,n,i]=t.match(/(https?:\/\/)(.+)/),[r,...l]=i.split("/");return`${n}${r.toLowerCase()}/${l.join("/")}`}getDomainCredentials(e){return this.trustedDomains&&this.trustedDomains.length&&this.trustedDomains.some((t=>e.startsWith(t)))?"include":"same-origin"}signOut(){return st.destroy(this)}createPostMessageHandler(e){return t=>{const o=e.indexOf(t.origin)>-1,n="arcgis:auth:requestCredential"===t.data.type,i=this.tokenExpires.getTime()>Date.now();if(o&&n){let e={};if(i){e={type:"arcgis:auth:credential",credential:this.toJSON()}}else e={type:"arcgis:auth:error",error:{name:"tokenExpiredError",message:"Token was expired, and not returned to the child application"}};t.source.postMessage(e,t.origin)}}}getTokenForServer(e,t){const o=this.getServerRootUrl(e),n=this.federatedServers[o];return n&&n.expires&&n.expires.getTime()>Date.now()?Promise.resolve(n.token):(this._pendingTokenRequests[o]||(this._pendingTokenRequests[o]=this.fetchAuthorizedDomains().then((()=>We(`${o}/rest/info`,{credentials:this.getDomainCredentials(e)}).then((n=>{if(n.owningSystemUrl){if(it(n.owningSystemUrl,this.portal))return We(`${n.owningSystemUrl}/sharing/rest/info`,t);throw new Ke(`${e} is not federated with ${this.portal}.`,Ve.NOT_FEDERATED)}if(n.authInfo&&void 0!==this.federatedServers[o])return Promise.resolve({authInfo:n.authInfo});throw new Ke(`${e} is not federated with any portal and is not explicitly trusted.`,Ve.NOT_FEDERATED)})).then((e=>this.token&&this.tokenExpires.getTime()<Date.now()?this.server?this.refreshCredentials().then((()=>({token:this.token,expires:this.tokenExpires}))):this.refreshCredentials().then((()=>this.generateTokenForServer(e.authInfo.tokenServicesUrl,o))):this.generateTokenForServer(e.authInfo.tokenServicesUrl,o))).then((e=>(this.federatedServers[o]=e,delete this._pendingTokenRequests[o],e.token)))))),this._pendingTokenRequests[o])}generateTokenForServer(e,t){return We(e,{params:{token:this.token,serverUrl:t,expiration:this.tokenDuration}}).then((e=>({token:e.token,expires:new Date(e.expires-3e5)}))).catch((e=>{throw new Ke(e.message,Ve.GENERATE_TOKEN_FOR_SERVER_FAILED,e.response,e.url,e.options)}))}getFreshToken(e){return this.token&&!this.tokenExpires||this.token&&this.tokenExpires&&this.tokenExpires.getTime()>Date.now()?Promise.resolve(this.token):(this._pendingTokenRequests[this.portal]||(this._pendingTokenRequests[this.portal]=this.refreshCredentials(e).then((()=>(this._pendingTokenRequests[this.portal]=null,this.token)))),this._pendingTokenRequests[this.portal])}refreshWithUsernameAndPassword(e){const t={username:this.username,password:this.password,expiration:this.tokenDuration,client:"referer",referer:this.referer?this.referer:"undefined"!=typeof window&&void 0!==window.document&&window.location&&window.location.origin?window.location.origin:qe};return(this.server?We(`${this.getServerRootUrl(this.server)}/rest/info`).then((o=>We(o.authInfo.tokenServicesUrl,Object.assign({params:t},e)))):We(`${this.portal}/generateToken`,Object.assign({params:t},e))).then((e=>(this.updateToken(e.token,new Date(e.expires)),this))).catch((e=>{throw new Ke(e.message,Ve.TOKEN_REFRESH_FAILED,e.response,e.url,e.options)}))}refreshWithRefreshToken(e){if(this.refreshToken&&this.refreshTokenExpires&&this.refreshTokenExpires.getTime()-864e5<Date.now())return this.exchangeRefreshToken(e);const t=Object.assign({params:{client_id:this.clientId,refresh_token:this.refreshToken,grant_type:"refresh_token"}},e);return Xe(`${this.portal}/oauth2/token`,t).then((e=>this.updateToken(e.token,e.expires))).catch((e=>{throw new Ke(e.message,Ve.TOKEN_REFRESH_FAILED,e.response,e.url,e.options)}))}updateToken(e,t){return this._token=e,this._tokenExpires=t,this}exchangeRefreshToken(e){const t=Object.assign({params:{client_id:this.clientId,refresh_token:this.refreshToken,redirect_uri:this.redirectUri,grant_type:"exchange_refresh_token"}},e);return Xe(`${this.portal}/oauth2/token`,t).then((e=>(this._token=e.token,this._tokenExpires=e.expires,this._refreshToken=e.refreshToken,this._refreshTokenExpires=e.refreshTokenExpires,this))).catch((e=>{throw new Ke(e.message,Ve.REFRESH_TOKEN_EXCHANGE_FAILED,e.response,e.url,e.options)}))}fetchAuthorizedDomains(){return this.server||!this.portal?Promise.resolve(this):this.getPortal().then((e=>(e.authorizedCrossOriginDomains&&e.authorizedCrossOriginDomains.length&&(this.trustedDomains=e.authorizedCrossOriginDomains.filter((e=>!e.startsWith("http://"))).map((e=>e.startsWith("https://")?e:`https://${e}`))),this)))}}function at(e){return console.log("DEPRECATED:, 'UserSession' is deprecated. Use 'ArcGISIdentityManager' instead."),new st(e)}var ut;at.beginOAuth2=function(...e){return console.warn("DEPRECATED:, 'UserSession.beginOAuth2' is deprecated. Use 'ArcGISIdentityManager.beginOAuth2' instead."),st.beginOAuth2(...e)},at.completeOAuth2=function(...e){return console.warn("DEPRECATED:, 'UserSession.completeOAuth2()' is deprecated. Use 'ArcGISIdentityManager.completeOAuth2()' instead."),e.length<=1&&console.warn("WARNING:, 'UserSession.completeOAuth2()' is now async and returns a promise the resolves to an instance of `ArcGISIdentityManager`."),st.completeOAuth2(...e)},at.fromParent=function(...e){return console.warn("DEPRECATED:, 'UserSession.fromParent' is deprecated. Use 'ArcGISIdentityManager.fromParent' instead."),st.fromParent(...e)},at.authorize=function(...e){return console.warn("DEPRECATED:, 'UserSession.authorize' is deprecated. Use 'ArcGISIdentityManager.authorize' instead."),st.authorize(...e)},at.exchangeAuthorizationCode=function(...e){return console.warn("DEPRECATED:, 'UserSession.exchangeAuthorizationCode' is deprecated. Use 'ArcGISIdentityManager.exchangeAuthorizationCode' instead."),st.exchangeAuthorizationCode(...e)},at.fromCredential=function(...e){return console.log("DEPRECATED:, 'UserSession.fromCredential' is deprecated. Use 'ArcGISIdentityManager.fromCredential' instead."),console.warn("WARNING:, 'UserSession.fromCredential' now requires a `ServerInfo` object from the JS API as a second parameter."),st.fromCredential(...e)},at.deserialize=function(...e){return console.log("DEPRECATED:, 'UserSession.deserialize' is deprecated. Use 'ArcGISIdentityManager.deserialize' instead."),st.deserialize(...e)},function(e){e.Success="Succeeded",e.Failed="Failed",e.Waiting="Waiting",e.Cancelled="Cancelled",e.Cancelling="Cancelling",e.New="New",e.Executing="Executing",e.Submitted="Submitted",e.Failure="Failure",e.TimedOut="TimedOut",e.Error="Error",e.Status="Etatus",e.Unknown="Unknown"}(ut||(ut={}));class ct{constructor(e=""){this.termStack=[],this.rangeStack=[],this.openGroups=0,this.q=e}match(...e){return this.termStack=this.termStack.concat(e),this}in(e){const t=`\`in(${e?`"${e}"`:""})\``;return this.hasRange||this.hasTerms?(e&&"*"!==e&&(this.q+=`${e}:`),this.commit()):(Fe(`${t} was called with no call to \`match(...)\` or \`from(...)\`/\`to(...)\`. Your query was not modified.`),this)}startGroup(){return this.commit(),this.openGroups>0&&(this.q+=" "),this.openGroups++,this.q+="(",this}endGroup(){return this.openGroups<=0?(Fe("`endGroup(...)` was called without calling `startGroup(...)` first. Your query was not modified."),this):(this.commit(),this.openGroups--,this.q+=")",this)}and(){return this.addModifier("and")}or(){return this.addModifier("or")}not(){return this.addModifier("not")}from(e){return this.hasTerms?(Fe('`from(...)` is not allowed after `match(...)` try using `.from(...).to(...).in(...)`. Optionally, you may see this because dates are incorrectly formatted. Dates should be a primative Date value, aka a number in milliseconds or Date object, ie new Date("2020-01-01").  Your query was not modified.'),this):(this.rangeStack[0]=e,this)}to(e){return this.hasTerms?(Fe('`to(...)` is not allowed after `match(...)` try using `.from(...).to(...).in(...)`. Optionally, you may see this because dates are incorrectly formatted. Dates should be a primative Date value, aka a number in milliseconds or Date object, ie new Date("2020-01-01"). Your query was not modified.'),this):(this.rangeStack[1]=e,this)}boost(e){return this.commit(),this.q+=`^${e}`,this}toParam(){return this.commit(),this.cleanup(),this.q}clone(){return this.commit(),this.cleanup(),new ct(this.q+"")}addModifier(e){return this.currentModifer?(Fe(`You have called \`${this.currentModifer}()\` after \`${e}()\`. Your current query was not modified.`),this):(this.commit(),""===this.q&&"not"!==e?(Fe(`You have called \`${e}()\` without calling another method to modify your query first. Try calling \`match()\` first.`),this):(this.currentModifer=e,this.q+=""===this.q?"":" ",this.q+=`${e.toUpperCase()} `,this))}hasWhiteSpace(e){return/\s/g.test(e)}formatTerm(e){return e instanceof Date?e.getTime():"string"==typeof e&&this.hasWhiteSpace(e)?`"${e}"`:e}commit(){return this.currentModifer=void 0,this.hasRange&&(this.q+=`[${this.formatTerm(this.rangeStack[0])} TO ${this.formatTerm(this.rangeStack[1])}]`,this.rangeStack=[void 0,void 0]),this.hasTerms&&(this.q+=this.termStack.map((e=>this.formatTerm(e))).join(" "),this.termStack=[]),this}get hasTerms(){return this.termStack.length>0}get hasRange(){return this.rangeStack.length&&this.rangeStack[0]&&this.rangeStack[1]}cleanup(){if(this.openGroups>0)for(Fe(`Automatically closing ${this.openGroups} group(s). You can use \`endGroup(...)\` to remove this warning.`);this.openGroups>0;)this.q+=")",this.openGroups--;const e=this.q;this.q=e.replace(/( AND ?| NOT ?| OR ?)*$/,""),e!==this.q&&Fe("`startGroup(...)` was called without calling `endGroup(...)` first. Your query was not modified."),this.q=this.q.replace(/(\(\))*/,"")}}var dt=v(79860),pt=function(e,t,o,n){return new(o||(o=Promise))((function(i,r){function l(e){try{a(n.next(e))}catch(e){r(e)}}function s(e){try{a(n.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(l,s)}a((n=n.apply(e,t||[])).next())}))};function mt(t,o,n,i){var r,l;let s=(new ct).match(o).in("type");i&&(s=s.and().startGroup().not().match(i).in("type").endGroup()),t&&(s=s.and().startGroup().match(t).endGroup());const a=(0,e.getAppStore)().getState(),u=null===(l=null===(r=null==a?void 0:a.portalSelf)||void 0===r?void 0:r.user)||void 0===l?void 0:l.orgId;return n===(null==a?void 0:a.portalUrl)&&u&&(s=s.and().match(u).in("orgid")),s.toParam()}var vt=v(1888);const ht=[{name:"preventOverflow",options:{altAxis:!0}}],gt=e.css`
  .dropdown >.dropdown-button:hover,  .dropdown >.dropdown-button{
    background: var(--ref-palette-neutral-300);
    border: 1px solid var(--ref-palette-neutral-300);
    border-radius: ${e.polished.rem(2)};
    text-align: left;
  }
`,ft=(0,vt.styled)(n.DropdownMenu)`
  & .dropdown-item-con{
    max-height: ${e.polished.rem(400)};
    max-width: ${e.polished.rem(300)};
    min-width: ${e.polished.rem(227)};
    overflow: auto;
  }
  .search-container{
    padding: 0 0.5rem 0.5rem 0.5rem;
  }
  .loading-placeholder, .loading-con {
    width: ${e.polished.rem(16)};
    height: ${e.polished.rem(16)};
  }
  .loading-con {
    @keyframes loading {
      0% {transform: rotate(0deg)};
      100% {transform: rotate(360deg)};
    }
    position: absolute;
    right: ${e.polished.rem(8)};
    bottom: ${e.polished.rem(2)};
    min-width: ${e.polished.rem(16)};
    border: 2px solid var(--ref-palette-neutral-1000);
    border-radius: 50%;
    border-top: 2px solid var(--sys-color-primary-main);
    box-sizing: border-box;
    animation:loading 2s infinite linear;
    box-sizing: border-box;
  }
`,{useState:yt,useRef:bt,useEffect:xt}=e.React,wt=t=>{const o=bt(null),i=bt(null),r=bt(null),l=bt(1),s=bt(""),a=bt((0,e.Immutable)([])),u=bt(null),c=bt(null),d=bt(null),p=e.hooks.useTranslation(n.defaultMessages),{portalUrl:m,title:v,className:h,size:g,buttonProps:f,menuProps:y,zIndex:b,fluid:x,autoWidth:w,appendToBody:T,strategy:S,useKeyUpEvent:I,hideSearchInput:C,itemtype:R,activeItem:O,placeholder:k,excludeType:j,onChange:E}=t,[N,A]=yt(!1),[P,M]=yt(""),[L,D]=yt(!1),[_,U]=yt((0,e.Immutable)([]));xt((()=>{d.current=m,z()}),[m]);const z=e.hooks.useEventCallback((()=>{if(l.current<0||!d.current)return;const t=e.SessionManager.getInstance().getSessionByUrl(d.current),o={searchText:P,start:l.current,searchItemtype:R||"Layout",portalUrl:d.current,excludeType:j};t&&(o.authentication=t),D(!0),function(e){return pt(this,void 0,void 0,(function*(){const{searchText:t,portalUrl:o,num:n,start:i,sortField:r,sortOrder:l,searchItemtype:s,excludeType:a,authentication:u}=e;if(!o)return Promise.reject("No portal url");const c={start:i||1,num:n||30,q:mt(t,s,o,a),sortField:r||"modified",sortOrder:l||"desc"};return u&&(c.authentication=u),dt.appServices.searchAppByPortalUrl(c,o)}))}(o).then((t=>{var o;if(D(!1),t){let n=1===l.current?[]:null===(o=a.current)||void 0===o?void 0:o.asMutable({deep:!0});l.current=null==t?void 0:t.nextStart;const i=(null==t?void 0:t.results)||[];n=n.concat(i),a.current=(0,e.Immutable)(n),U((0,e.Immutable)(n))}})).catch((e=>{D(!1)}))})),$=t=>{l.current=1,s.current=t.target.value,M(t.target.value),clearTimeout(u.current),a.current=(0,e.Immutable)([]),u.current=setTimeout((()=>{z()}),500)},G=e=>{e&&c.current&&function(e,t,o,n){const i=new IntersectionObserver((function(e,t){const n=e[0].intersectionRatio>0;o&&o(n)}),n||{root:t});i.observe(e)}(c.current,e,F)},F=(e=!1)=>{var t;e&&(null===(t=a.current)||void 0===t?void 0:t.length)>0&&z()};return(0,e.jsx)("div",{className:(0,e.classNames)("app-item-selector-con w-100",h),css:gt},(0,e.jsx)(n.Dropdown,{className:"w-100",size:g,direction:"down",fluid:x,autoWidth:w,toggle:()=>{A(!N)},isOpen:N,useKeyUpEvent:I,handelTabEvent:e=>{const t=!C&&i.current;let o;return"Tab"===e.key&&e.shiftKey?o=t:"Tab"===e.key&&e.shiftKey,!!o&&(e.preventDefault(),o.focus(),!0)}},(0,e.jsx)(n.DropdownButton,Object.assign({size:g},f,{title:v||(null==O?void 0:O.title),innerRef:e=>{o.current=e},"aria-label":t["aria-label"],"aria-describedby":t["aria-describedby"],"a11y-description":t["a11y-description"]}),(null==O?void 0:O.title)||k),(0,e.jsx)(ft,Object.assign({appendToBody:T,strategy:S,zIndex:b+"",className:"shadow-3",modifiers:ht,trapFocus:!1},y),m&&(0,e.jsx)("div",null,!C&&(0,e.jsx)("div",{className:"search-container"},(0,e.jsx)(n.TextInput,{prefix:(0,e.jsx)(Le,null),allowClear:!0,size:"sm",type:"text",value:P,ref:i,placeholder:p("SearchLabel"),onChange:$})),(0,e.jsx)("div",{className:"dropdown-item-con",ref:e=>{G(e)}},_.map(((t,o)=>(0,e.jsx)(n.DropdownItem,{ref:e=>{((e,t)=>{0===t&&e&&(r.current=e)})(e,o)},key:o,className:"select-item text-truncate d-block text-left",onClick:e=>{(e=>{e.id!==(null==O?void 0:O.id)&&E&&E(e)})(null==t?void 0:t.asMutable({deep:!0}))},active:(null==O?void 0:O.id)===t.id,title:t.title},t.title))),(null==_?void 0:_.length)>0&&!L&&(0,e.jsx)("span",{ref:c}),0===(null==_?void 0:_.length)&&!L&&(0,e.jsx)(n.DropdownItem,{disabled:!0},p("noItemsFound")),L&&(0,e.jsx)("div",{className:"loading-item"},(0,e.jsx)("div",{className:"loading-placeholder"}),(0,e.jsx)("div",{className:"loading-con"})))))))};var Tt=function(e,t,o,n){return new(o||(o=Promise))((function(i,r){function l(e){try{a(n.next(e))}catch(e){r(e)}}function s(e){try{a(n.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(l,s)}a((n=n.apply(e,t||[])).next())}))};const{useState:St,useEffect:It,useRef:Ct}=e.React,Rt=e.css`
  .radio-con {
    cursor: pointer;
  }
`,Ot=t=>{const o=e.hooks.useTranslation(T),r=Ct(null),{id:l,template:s,config:a,templateIndex:u,handleLayoutChange:c,onSettingChange:d,toggleLoading:p}=t,[m,v]=St(null),[h,f]=St(null),[y,x]=St(!1);It((()=>{r.current=null==s?void 0:s.customLayoutItem}),[s]),It((()=>{v(r.current)}),[u]),It((()=>{I(a.useUtility).then((e=>{f(e)})),O(a.useUtility)}),[a.useUtility]);const w=e=>Tt(void 0,void 0,void 0,(function*(){const t={id:e.id,title:e.title};v(t),p(!0),C(a,t,u).then((e=>{p(!1),d({id:l,config:e})}),(e=>{v((null==s?void 0:s.customLayoutItem)||null),p(!1)}))})),S=()=>{var e,t;const o=s.set("layoutTypes",b.CustomLayout).set("customLayoutItem",null),n=(null==a?void 0:a.printTemplateType)===g.Customize?null===(e=a.printCustomTemplate)||void 0===e?void 0:e.asMutable({deep:!0}):null===(t=a.printOrgTemplate)||void 0===t?void 0:t.asMutable({deep:!0});n[u]=null==o?void 0:o.asMutable({deep:!0});const i=(null==a?void 0:a.printTemplateType)===g.Customize?a.set("printCustomTemplate",n):a.set("printOrgTemplate",n);v(null),d({id:l,config:i})},R=()=>{var e,t;const o=null===(t=null===(e=null==a?void 0:a.layoutChoiceList)||void 0===e?void 0:e[u])||void 0===t?void 0:t.layout;c(q(o))},O=t=>Tt(void 0,void 0,void 0,(function*(){var o,n;const i=yield B(null==t?void 0:t.asMutable({deep:!0})),r=(null===(o=(0,e.getAppStore)().getState().portalSelf)||void 0===o?void 0:o.helperServices)||{},l=null===(n=null==r?void 0:r.printTask)||void 0===n?void 0:n.url;x((!i||i!==l)&&a.supportCustomLayout)}));return(0,e.jsx)("div",{className:"custom-layout-setting-con mt-2",css:Rt},(0,e.jsx)(i.SettingRow,{flow:"wrap",label:o("printLayout")}),(()=>{var t,r;const l=!(null==s?void 0:s.layoutTypes)||(null==s?void 0:s.layoutTypes)===b.ServiceLayout||!y,u=(null===(t=null==a?void 0:a.layoutChoiceList)||void 0===t?void 0:t.length)>0;return(0,e.jsx)("div",{role:"group","aria-label":o("printLayout")},y&&u&&(0,e.jsx)(i.SettingRow,null,(0,e.jsx)("div",{className:"d-flex radio-con align-items-center",title:o("useServiceLayout"),onClick:R},(0,e.jsx)(n.Radio,{className:"mr-1",checked:l,title:o("useServiceLayout")}),(0,e.jsx)("span",null,o("useServiceLayout")))),y&&u&&(0,e.jsx)(i.SettingRow,null,(0,e.jsx)("div",{className:"d-flex radio-con align-items-center",title:o("useCustomLayout"),onClick:S},(0,e.jsx)(n.Radio,{checked:(null==s?void 0:s.layoutTypes)===b.CustomLayout,className:"mr-1",title:o("useCustomLayout")}),(0,e.jsx)("span",null,o("useCustomLayout")))),l&&(0,e.jsx)(i.SettingRow,null,(0,e.jsx)(n.Select,{value:q(null==s?void 0:s.layout),onChange:e=>{c(e.target.value)},size:"sm",disabled:(null==a?void 0:a.printTemplateType)===g.OrganizationTemplate,"aria-label":o("printLayout")},null===(r=null==a?void 0:a.layoutChoiceList)||void 0===r?void 0:r.map(((t,o)=>(0,e.jsx)(n.Option,{key:`layout${o}`,value:null==t?void 0:t.layoutTemplate,title:null==t?void 0:t.layoutTemplate},null==t?void 0:t.layoutTemplate))))),(null==s?void 0:s.layoutTypes)===b.CustomLayout&&y&&(0,e.jsx)(i.SettingRow,null,(0,e.jsx)(wt,{portalUrl:h,activeItem:m,itemtype:"Layout",size:"sm",placeholder:o("selectLayoutItemPlaceholder"),onChange:w})))})())};var kt=v(13089),jt=v(45508),Et=v.n(jt),Nt=function(e,t){var o={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(o[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(o[n[i]]=e[n[i]])}return o};const At=t=>{const o=window.SVG,{className:n}=t,i=Nt(t,["className"]),r=(0,e.classNames)("jimu-icon jimu-icon-component",n);return o?e.React.createElement(o,Object.assign({className:r,src:Et()},i)):e.React.createElement("svg",Object.assign({className:r},i))},Pt=e.css`
  & .loading-con {
    width: ${e.polished.rem(16)};
    height: ${e.polished.rem(16)};
  }
`,Mt=t=>{const{text:o,className:i}=t;return(0,e.jsx)("div",{css:Pt,className:(0,e.classNames)(i,"d-flex align-items-center")},(0,e.jsx)("div",{className:"loading-con position-relative mr-1"},(0,e.jsx)(n.Loading,{width:16,height:16,type:n.LoadingType.Donut})),(0,e.jsx)("div",null,o))};var Lt=function(e,t,o,n){return new(o||(o=Promise))((function(i,r){function l(e){try{a(n.next(e))}catch(e){r(e)}}function s(e){try{a(n.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(l,s)}a((n=n.apply(e,t||[])).next())}))};const{useState:Dt,useEffect:_t}=e.React,Ut=e.css`
  .report-temp-tip-button {
    padding: 0;
  }
  .radio-con {
    cursor: pointer;
  }
  .warning-alert-con {
    position: absolute;
    top: ${e.polished.rem(50)};
    right: ${e.polished.rem(8)};
    left: ${e.polished.rem(8)};
  }
`,zt=t=>{const r=e.hooks.useTranslation(T),{id:l,template:s,config:a,templateIndex:u,onSettingChange:c}=t,[p,m]=Dt(null),[v,h]=Dt(null),[f,y]=Dt(!1);_t((()=>{m(null==s?void 0:s.customReportItem)}),[u]),_t((()=>{I(a.useUtility).then((e=>{h(e)}))}),[a.useUtility]);const b=(e=!1)=>{y(e)},C=e=>Lt(void 0,void 0,void 0,(function*(){const t={id:e.id,title:e.title};m(t),b(!0),((e,t,o)=>S(void 0,void 0,void 0,(function*(){const n=null==t?void 0:t.id;return n?R(n,null==e?void 0:e.useUtility,d.ReportTemplate).then((n=>{var i,r;const l=null==n?void 0:n[0],s=((null==e?void 0:e.printTemplateType)===g.Customize?null===(i=e.printCustomTemplate)||void 0===i?void 0:i.asMutable({deep:!0}):null===(r=e.printOrgTemplate)||void 0===r?void 0:r.asMutable({deep:!0}))[o];s.customReportItem=t,s.reportOptions=(null==l?void 0:l.reportOptions)||{};const a=Y(e,o,s);return Promise.resolve(a)}),(e=>Promise.reject(e))).catch((e=>Promise.reject(e))):Promise.reject("No custom report item id")})))(a,t,u).then((e=>{b(!1),c({id:l,config:e})}),(e=>{m((null==s?void 0:s.customLayoutItem)||null),b(!1)}))})),O=()=>{let e=s.set("reportTypes",w.CustomReport);m((null==a?void 0:a.defaultCustomReportItem)||null),e=e.set("customReportItem",null).set("reportOptions",null);const t=Y(a,u,null==e?void 0:e.asMutable({deep:!0}));c({id:l,config:t})},k=()=>{var e;let t=s.set("reportTypes",w.ServiceReport),o=null;const n=(null==a?void 0:a.defaultReportTemplate)||"";(null==a?void 0:a.defaultReportTemplate)&&(null===(e=null==a?void 0:a.reportTemplateChoiceList)||void 0===e||e.forEach((e=>{e.reportTemplate===(null==a?void 0:a.defaultReportTemplate)&&(o=e.reportOptions)}))),t=t.set("report",n).set("reportOptions",o);const i=Y(a,u,null==t?void 0:t.asMutable({deep:!0}));c({id:l,config:i})},j=(t,n)=>{var i,r,c;const d=function(t){var o,n,i;return null!==(i=null===(n=null===(o=e.DataSourceManager.getInstance().getDataSource(t))||void 0===o?void 0:o.getDataSourceJson())||void 0===n?void 0:n.isOutputFromWidget)&&void 0!==i&&i}(null===(i=t[0])||void 0===i?void 0:i.dataSourceId),p=s.setIn(["reportOptions","reportSectionOverrides",n,"exbDatasource"],t).setIn(["reportOptions","reportSectionOverrides",n,"isDsOutputDs"],d),m=Y(a,u,null==p?void 0:p.asMutable({deep:!0})),v=(null===(r=(0,e.getAppStore)().getState().appStateInBuilder.appConfig)||void 0===r?void 0:r.widgets)[l],h={id:l},g=(0,o.getAppConfigAction)(),f=(null===(c=v.useDataSources)||void 0===c?void 0:c.asMutable({deep:!0}))||[];!E(t[0],f)&&t[0]&&f.push(t[0]),h.config=m,h.useDataSources=f,g.editWidget(h).exec()},E=(e,t)=>!(!e||!t)&&(null==t?void 0:t.some((t=>t.dataSourceId===e.dataSourceId))),N=t=>{const o=function(t){if(!t)return!1;const o=e.DataSourceManager.getInstance().getDataSource(t.id);return o&&o.supportSpatialInfo&&!o.supportSpatialInfo()}(t);if(o)return!0;const n=e.DataSourceManager.getInstance();let i=!1;const r=e=>{var t,o,n;i||("MAP_SERVICE"===(null===(t=null==e?void 0:e.parentDataSource)||void 0===t?void 0:t.type)?i=!0:(null===(o=null==e?void 0:e.parentDataSource)||void 0===o?void 0:o.parentDataSource)&&r(null===(n=null==e?void 0:e.parentDataSource)||void 0===n?void 0:n.parentDataSource))},l=n.getDataSource(t.id);return r(l),i},A=e.hooks.useEventCallback((()=>{if(!(null==s?void 0:s.reportOptions))return!0;return Q(null==s?void 0:s.reportOptions)===x.RPTX})),P=e.hooks.useEventCallback((()=>{const e=(null==a?void 0:a.supportReport)&&(null==a?void 0:a.defaultReportTemplate)&&!(null==a?void 0:a.supportCustomReport),t=(null==s?void 0:s.reportTypes)===w.CustomReport&&!(null==s?void 0:s.customReportItem);return(e&&t||!A())&&!f}));return(0,e.jsx)("div",{className:"custom-layout-setting-con mt-2",css:Ut},(0,e.jsx)(i.SettingRow,{flow:"wrap",label:(0,e.jsx)("div",{className:"d-flex align-items-center"},(0,e.jsx)("div",{className:"mr-1"},r("report")),(0,e.jsx)(n.Tooltip,{title:r("reportRemind"),showArrow:!0,placement:"left"},(0,e.jsx)(n.Button,{className:"report-temp-tip-button",type:"tertiary","aria-label":r("reportRemind")},(0,e.jsx)(At,{size:"s"}))))}),(()=>{var t;const o=a.supportCustomReport,d=!(null==s?void 0:s.reportTypes)||(null==s?void 0:s.reportTypes)===w.ServiceReport||!o,m=ue(null===(t=null==a?void 0:a.reportTemplateChoiceList)||void 0===t?void 0:t.asMutable({deep:!0}),!(null==a?void 0:a.defaultReportTemplate)),h=o&&!(null==a?void 0:a.defaultCustomReportItem);return(0,e.jsx)("div",{role:"group","aria-label":r("report")},h&&(0,e.jsx)(i.SettingRow,null,(0,e.jsx)("div",{className:"d-flex radio-con align-items-center",title:r("useServiceReport"),onClick:k},(0,e.jsx)(n.Radio,{className:"mr-1",checked:d,title:r("useServiceReport")}),(0,e.jsx)("span",null,r("useServiceReport")))),h&&(0,e.jsx)(i.SettingRow,null,(0,e.jsx)("div",{className:"d-flex radio-con align-items-center",title:r("useCustomReport"),onClick:O},(0,e.jsx)(n.Radio,{checked:(null==s?void 0:s.reportTypes)===w.CustomReport,className:"mr-1",title:r("useCustomReport")}),(0,e.jsx)("span",null,r("useCustomReport")))),d&&(0,e.jsx)(i.SettingRow,null,(0,e.jsx)(n.Select,{value:(null==s?void 0:s.report)||"None",onChange:(e,t)=>{((e,t)=>{var o,n;const i=t.key;let r=!1;a.supportCustomReport&&(null==s?void 0:s.reportTypes)===w.CustomReport?r=!a.defaultCustomReportItem:a.supportReport&&(null==s?void 0:s.reportTypes)===w.ServiceReport&&(r=!a.defaultReportTemplate);const d=ue(null===(o=null==a?void 0:a.reportTemplateChoiceList)||void 0===o?void 0:o.asMutable({deep:!0}),r);let p=null;"None"===d[i].reportTemplate&&r&&0===Number(i)?e="":p=(null===(n=d[i])||void 0===n?void 0:n.reportOptions)||null;const m=s.set("reportOptions",p).set("report",e),v=Y(a,u,null==m?void 0:m.asMutable({deep:!0}));c({id:l,config:v})})(e.target.value,t)},size:"sm",disabled:(null==a?void 0:a.printTemplateType)===g.OrganizationTemplate,"aria-label":r("report")},null==m?void 0:m.map(((t,o)=>(0,e.jsx)(n.Option,{key:o,value:null==t?void 0:t.reportTemplate,title:null==t?void 0:t.reportTemplate},null==t?void 0:t.reportTemplate))))),(null==s?void 0:s.reportTypes)===w.CustomReport&&a.supportCustomReport&&(0,e.jsx)(i.SettingRow,null,(0,e.jsx)(wt,{portalUrl:v,activeItem:p,itemtype:"Pro Report",excludeType:"Pro Report Template",size:"sm",placeholder:r("selectReportItemPlaceholder"),onChange:C})),f&&(0,e.jsx)(Mt,{className:"mt-2",text:r("checkingReport")}),P()&&(0,e.jsx)("div",{className:"warning-alert-con"},(0,e.jsx)(n.Alert,{type:"warning",text:r("notSupportReport"),withIcon:!0})))})(),(()=>{const e=A();return!f&&e})()&&(()=>{var t,o;const n=(null===(t=null==s?void 0:s.reportOptions)||void 0===t?void 0:t.reportSectionOverrides)||(0,e.Immutable)({});if(0!==(null===(o=Object.keys(n))||void 0===o?void 0:o.length))return(0,e.jsx)("div",{className:"mt-3"},Object.keys(n).map(((t,o)=>{const r=n[t];return(0,e.jsx)(i.SettingRow,{label:t,flow:"wrap",key:o},(0,e.jsx)(kt.DataSourceSelector,{types:(0,e.Immutable)([e.AllDataSourceTypes.FeatureLayer]),useDataSources:null==r?void 0:r.exbDatasource,mustUseDataSource:!0,onChange:e=>{j(e,t)},widgetId:l,closeDataSourceListOnChange:!0,"aria-describedby":"list-empty-tip",hideDataView:!0,hideDs:N}))})))})())};var $t=v(28996),Gt=v.n($t),Ft=function(e,t){var o={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(o[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(o[n[i]]=e[n[i]])}return o};const qt=t=>{const o=window.SVG,{className:n}=t,i=Ft(t,["className"]),r=(0,e.classNames)("jimu-icon jimu-icon-component",n);return o?e.React.createElement(o,Object.assign({className:r,src:Gt()},i)):e.React.createElement("svg",Object.assign({className:r},i))};var Ht=function(e,t,o,n){return new(o||(o=Promise))((function(i,r){function l(e){try{a(n.next(e))}catch(e){r(e)}}function s(e){try{a(n.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(l,s)}a((n=n.apply(e,t||[])).next())}))};const{useEffect:Bt,useState:Wt,useRef:Vt}=e.React,Zt=v(12046);var Kt;!function(e){e.MapSize="MAP SIZE",e.Author="AUTHOR",e.Copyright="COPYRIGHT",e.Legend="LEGEND",e.ScaleBarUnit="SCALE BAR UNIT",e.AttributionVisible="ATTRIBUTION VISIBLE",e.CustomTextElements="CUSTOM TEXZT ELEMENTS",e.NorthArrow="NORTH ARROW"}(Kt||(Kt={}));const Jt=t=>{var o,r,l,s,a;const u=e.hooks.useTranslation(T,n.defaultMessages,e.defaultMessages),{id:c,isOpen:d,trigger:m,popperFocusNode:v,config:h,activeTemplateId:f,jimuMapView:y,toggle:x,handelTemplateListChange:w,onSettingChange:S}=t,I=Vt(null),C=Vt(null),R=Vt(null);Bt((()=>{me()}),[h,f]);const[O,k]=Wt(null),[j,E]=Wt(null),[N,A]=Wt(null),[P,M]=Wt((null==O?void 0:O.label)||""),[L,D]=Wt(null===(o=null==O?void 0:O.exportOptions)||void 0===o?void 0:o.width),[_,U]=Wt(null===(r=null==O?void 0:O.exportOptions)||void 0===r?void 0:r.height),[z,q]=Wt((null===(l=null==O?void 0:O.layoutOptions)||void 0===l?void 0:l.authorText)||""),[B,W]=Wt((null===(s=null==O?void 0:O.layoutOptions)||void 0===s?void 0:s.copyrightText)||""),[V,K]=Wt(null),[Q,Y]=Wt(null===(a=null==O?void 0:O.layoutOptions)||void 0===a?void 0:a.customTextElements),[ee,te]=Wt(null),[oe,ne]=Wt(!1),[ie,re]=Wt(null),[le,se]=Wt(!1);Bt((()=>(_e(I.current),C.current=null,"number"==typeof j&&(I.current=j),()=>{_e(I.current)})),[j]),Bt((()=>{var e,t,o,n,i,r;re(J(null===(e=null==O?void 0:O.layoutOptions)||void 0===e?void 0:e.elementOverrides)),M((null==O?void 0:O.label)||""),D(null===(t=null==O?void 0:O.exportOptions)||void 0===t?void 0:t.width),U(null===(o=null==O?void 0:O.exportOptions)||void 0===o?void 0:o.height),q((null===(n=null==O?void 0:O.layoutOptions)||void 0===n?void 0:n.authorText)||""),W((null===(i=null==O?void 0:O.layoutOptions)||void 0===i?void 0:i.copyrightText)||""),Y(null===(r=null==O?void 0:O.layoutOptions)||void 0===r?void 0:r.customTextElements),ue(O)}),[O]),Bt((()=>{pe()}),[]),Bt((()=>{ce()&&pe()}),[Q]);const ue=e=>{const{defaultCustomReportItem:t,defaultReportTemplate:o,supportCustomReport:n,supportReport:i}=h;if(!e)return;if(X({defaultCustomReportItem:t,defaultReportTemplate:o,supportCustomReport:n,supportReport:i,reportOptions:null==e?void 0:e.reportOptions,reportTypes:null==e?void 0:e.reportTypes})){const t={reportOptions:null==e?void 0:e.reportOptions,reportTypes:null==e?void 0:e.reportTypes,customReportItem:null==e?void 0:e.customReportItem,report:null==e?void 0:e.report,templateIndex:j,templateId:e.templateId};C.current=t}},ce=()=>{if(!Q)return!1;if((null==Q?void 0:Q.length)!==(null==ee?void 0:ee.length))return!0;{let e=!1;return null==Q||Q.forEach(((t,o)=>{for(const n in t)Object.prototype.hasOwnProperty.call(ee[o],n)||(e=!0)})),e}},de=(e=!1)=>{se(e)},pe=()=>{const t=null==Q?void 0:Q.map(((e,t)=>{const o={};for(const t in e)o[t]=!1;return o}));te((0,e.Immutable)(t||[]))},me=()=>{const e=F(null==h?void 0:h.printServiceType,null==h?void 0:h.printTemplateType)?null==h?void 0:h.printCustomTemplate:null==h?void 0:h.printOrgTemplate,t=G(null==e?void 0:e.asMutable({deep:!0}),f);E(t),A(e),k((null==e?void 0:e[t])||null),R.current=e},ve=(e,t)=>{const o=O.setIn(e,t),n=null==N?void 0:N.asMutable({deep:!0});n[j]=null==o?void 0:o.asMutable({deep:!0}),w(n)},he=e=>{if(!e)return M(null==O?void 0:O.label),!1;ve(["label"],e)},ge=e=>{var t;const o=null===(t=null==e?void 0:e.target)||void 0===t?void 0:t.value;M(o)},fe=e=>{var t;if(!e||Number(e)<1)return D(null===(t=null==O?void 0:O.exportOptions)||void 0===t?void 0:t.width),!1;ve(["exportOptions","width"],Number(e))},ye=e=>{if(e<1)return!1;D(e)},be=e=>{var t;if(!e||Number(e)<1)return U(null===(t=null==O?void 0:O.exportOptions)||void 0===t?void 0:t.height),!1;ve(["exportOptions","height"],Number(e))},xe=e=>{var t;const o=null===(t=null==e?void 0:e.target)||void 0===t?void 0:t.value;q(o)},we=e=>{ve(["layoutOptions","authorText"],e)},Te=e=>{var t;const o=null===(t=null==e?void 0:e.target)||void 0===t?void 0:t.value;W(o)},Se=e=>{ve(["layoutOptions","copyrightText"],e)},Ie=e=>{U(e)},Ce=e=>{Oe(),K(e)},Re=()=>{Oe(),K(null)},Oe=()=>{const e=null==ee?void 0:ee.map((e=>{const t={};for(const o in e)t[o]=!1;return t}));te(e)},ke=e=>{const t=e.target.value;ve(["layoutOptions","scalebarUnit"],t)},je=e=>{ve([e],!(null==O?void 0:O[e]))},Ee=e=>{const t=null==N?void 0:N.asMutable({deep:!0});t[j]=null==e?void 0:e.asMutable({deep:!0}),w(t)},Ae=()=>{const e=!(null==O?void 0:O.overrideCommonSetting);if(e){let t=O.setIn(["overrideCommonSetting"],e);t=$(t,null==h?void 0:h.commonSetting);const o=null==N?void 0:N.asMutable({deep:!0});o[j]=null==t?void 0:t.asMutable({deep:!0}),w(o)}else ve(["overrideCommonSetting"],e)},Pe=e=>Ht(void 0,void 0,void 0,(function*(){const e=Me()?null:yield Z(y);ve(["layoutOptions","legendLayers"],e)})),Me=()=>{var e;return!!(null===(e=null==O?void 0:O.layoutOptions)||void 0===e?void 0:e.legendLayers)},Le=e=>{const t=!(null==O?void 0:O.attributionVisible);ve(["attributionVisible"],t)},De=(e,t)=>{const o=null==ee?void 0:ee.map(((o,n)=>{const i={};for(const r in o)i[r]=t===n&&r===e&&!ee[t][e];return i}));K(null),te(o)},_e=e=>{var t;const o="number"==typeof e?e:j,n=null===(t=R.current)||void 0===t?void 0:t.asMutable({deep:!0});let i=null==n?void 0:n[o];if(!i)return;let r=!1;const l=Ue(i);l.isTemplateChange&&(r=!0,i=l.newTemplateItem);const s=ze(i);s.isTemplateChange&&(r=!0,i=s.newTemplateItem),r&&(n[o]=i,w(n))},Ue=e=>{var t,o,n;if(!e)return{isTemplateChange:!1};let i=!1;return(null==e?void 0:e.layoutTypes)===b.CustomLayout&&!(null===(t=e.customLayoutItem)||void 0===t?void 0:t.id)&&(null===(o=null==h?void 0:h.layoutChoiceList)||void 0===o?void 0:o.length)>0&&(e=ae(e,e.layout,null===(n=null==h?void 0:h.layoutChoiceList)||void 0===n?void 0:n.asMutable({deep:!0})),i=!0),{isTemplateChange:i,newTemplateItem:e}},ze=e.hooks.useEventCallback((t=>{var o;if(!t)return{isTemplateChange:!1};const{defaultCustomReportItem:n,defaultReportTemplate:i,supportCustomReport:r,supportReport:l}=h;let s=!1,a=(0,e.Immutable)(t);if(!X({defaultCustomReportItem:n,defaultReportTemplate:i,supportCustomReport:r,supportReport:l,reportOptions:null==t?void 0:t.reportOptions,reportTypes:null==t?void 0:t.reportTypes})&&C.current&&(null===(o=C.current)||void 0===o?void 0:o.templateId)===t.templateId){const{reportOptions:e,reportTypes:t,customReportItem:o,report:n}=C.current;a=a.set("reportOptions",e).set("reportTypes",t).set("customReportItem",o).set("report",n).set("report",n),s=!0}return{isTemplateChange:s,newTemplateItem:null==a?void 0:a.asMutable({deep:!0})}})),$e=(e,t)=>{var o;const n="number"==typeof t?t:j,i=ae(null==O?void 0:O.asMutable({deep:!0}),e,null===(o=null==h?void 0:h.layoutChoiceList)||void 0===o?void 0:o.asMutable({deep:!0})),r=null==N?void 0:N.asMutable({deep:!0});r[n]=i,w(r)},Ge=(e,t)=>{var o,n;const i=null===(o=null==O?void 0:O.customTextElementEnableList)||void 0===o?void 0:o[t],r=i.set(e,!(null==i?void 0:i[e])),l=null===(n=null==O?void 0:O.customTextElementEnableList)||void 0===n?void 0:n.asMutable({deep:!0});l.splice(t,1,r),ve(["customTextElementEnableList"],l)},Fe=(e,t,o)=>{const n=Q[e].set(t,o),i=null==Q?void 0:Q.asMutable({deep:!0});i.splice(e,1,n),ve(["layoutOptions","customTextElements"],i)},qe=(t,o,n)=>{var i;const r=null===(i=null==n?void 0:n.target)||void 0===i?void 0:i.value,l=Q[t].set(o,r),s=null==Q?void 0:Q.asMutable({deep:!0});s.splice(t,1,l),Y((0,e.Immutable)(s))},He=()=>{var e,t,o;const n=null===(o=null===(t=null===(e=null==O?void 0:O.layoutOptions)||void 0===e?void 0:e.elementOverrides)||void 0===t?void 0:t[ie])||void 0===o?void 0:o.visible;ve(["layoutOptions","elementOverrides",ie,"visible"],!n)},Be=(e,t,o)=>{if(0===(null==o?void 0:o.length))return!1;let n=O.set("selectedFormatList",o);(null==o?void 0:o.includes(n.format))||(n=n.set("format",o[0]));const i=null==N?void 0:N.asMutable({deep:!0});i[j]=null==n?void 0:n.asMutable({deep:!0}),w(i)},We=()=>null==h?void 0:h.formatList.map(((e,t)=>({value:e,label:e}))),Ve=()=>{ne(!oe)},Ze=e.css`
    .remind-con {
      padding-left: ${e.polished.rem(25)};
      color: var(--ref-palette-neutral-1100);
      margin-bottom: ${e.polished.rem(60)};
      margin-top: ${e.polished.rem(19)};
      font-size: ${e.polished.rem(13)};
    }
    .modal-body {
      padding: ${e.polished.rem(30)} ${e.polished.rem(30)} 0 ${e.polished.rem(30)};
    }
    .modal-footer {
      padding: 0 ${e.polished.rem(30)} ${e.polished.rem(30)} ${e.polished.rem(30)};
    }
    .remind-title {
      font-size: ${e.polished.rem(16)};
      font-weight: 500;
    }
  `,Ke=e=>{e.target.checked?Ae():Ve()},Je=e.css`
    & {
      overflow: auto;
    }
    .text-wrap {
      overflow: hidden;
      white-space: pre-wrap;
    }
    .map-size-input {
      width: ${e.polished.rem(80)};
    }
    .setting-collapse {
      & {
        margin-bottom: ${e.polished.rem(8)};
      }
      .collapse-header {
        line-height: 2.2;
        padding-left: ${e.polished.rem(8)} !important;
        padding-right: ${e.polished.rem(8)} !important;
      }
    }
    .check-box-con {
      color: var(--ref-palette-neutral-900);
      font-size: ${e.polished.rem(14)};
      line-height: ${e.polished.rem(22)};
      margin: ${e.polished.rem(4)} 0 ${e.polished.rem(8)} 0;
    }
    .layout-loading-con {
      left: 0;
      height: ${e.polished.rem(100)};
    }
  `,Qe=e.hooks.useEventCallback(((e,t)=>{var o;const n=!(null==t?void 0:t.layoutTypes)||(null==t?void 0:t.layoutTypes)===b.ServiceLayout;return!e&&!(!n&&!(null===(o=t.customLayoutItem)||void 0===o?void 0:o.id))}));return(0,e.jsx)(i.SidePopper,{isOpen:d,position:"right",toggle:x,trigger:m,title:u("templateConfiguration"),backToFocusNode:v},(0,e.jsx)("div",{className:"w-100 h-100",css:Je},(0,e.jsx)(i.SettingSection,null,(0,e.jsx)(i.SettingRow,{flow:"wrap",label:u("templateName")},(0,e.jsx)(n.TextInput,{size:"sm",className:"w-100",value:P,onAcceptValue:he,onChange:ge,"aria-label":u("templateName"),disabled:(null==h?void 0:h.printTemplateType)===g.OrganizationTemplate})),(0,e.jsx)(i.SettingRow,{flow:"wrap",label:u("fileFormat"),role:"group","aria-label":u("fileFormat")},(0,e.jsx)(n.MultiSelect,{fluid:!0,"aria-label":u("fileFormat"),items:(0,e.Immutable)(We()),onClickItem:Be,values:(0,e.Immutable)((null==O?void 0:O.selectedFormatList)||[]),size:"sm"})),(0,e.jsx)(Ot,{id:c,config:h,template:O,templateIndex:j,handleLayoutChange:$e,onSettingChange:S,toggleLoading:de}),((null==h?void 0:h.supportCustomReport)||(null==h?void 0:h.supportReport))&&(0,e.jsx)(zt,{id:c,config:h,template:O,templateIndex:j,onSettingChange:S}),le&&(0,e.jsx)("div",{className:"layout-loading-con position-absolute w-100"},(0,e.jsx)(n.Loading,null))),Qe(le,O)&&(0,e.jsx)("div",null,H(null==O?void 0:O.layout)&&(0,e.jsx)(i.SettingSection,{title:u("MapOnlyOptions"),role:"group","aria-label":u("MapOnlyOptions")},(0,e.jsx)("div",{role:"group","aria-label":u("setDefaults")},(0,e.jsx)(i.SettingRow,{label:u("setDefaults"),flow:"wrap"}),(0,e.jsx)(n.CollapsablePanel,{label:u("mapSize"),isOpen:V===Kt.MapSize,onRequestOpen:()=>{Ce(Kt.MapSize)},onRequestClose:Re,role:"group","aria-label":u("mapSize"),rightIcon:Zt,type:"primary",className:V===Kt.MapSize&&"active-collapse"},(0,e.jsx)(i.SettingRow,{label:u("width"),className:"mt-2"},(0,e.jsx)(n.NumericInput,{className:"map-size-input",size:"sm",placeholder:u("width"),value:L||800,onAcceptValue:fe,onChange:ye,showHandlers:!1,"aria-label":u("width")})),(0,e.jsx)(i.SettingRow,{label:u("height")},(0,e.jsx)(n.NumericInput,{className:"map-size-input",size:"sm",placeholder:u("height"),value:_||1100,onAcceptValue:be,onChange:Ie,showHandlers:!1,"aria-label":u("height")}))),(0,e.jsx)(n.CollapsablePanel,{label:u("mapAttribution"),isOpen:V===Kt.AttributionVisible,onRequestOpen:()=>{Ce(Kt.AttributionVisible)},onRequestClose:Re,role:"group","aria-label":u("mapAttribution"),rightIcon:Zt,type:"primary",className:V===Kt.AttributionVisible&&"active-collapse"},(0,e.jsx)(i.SettingRow,{flow:"wrap",className:"mt-2"},(0,e.jsx)("div",{title:u("includeAttribution"),className:"d-flex w-100 align-items-center check-box-con",onClick:Le},(0,e.jsx)(n.Checkbox,{title:u("includeAttribution"),className:"lock-item-ratio","data-field":"mapSize",checked:!!(null==O?void 0:O.attributionVisible)||!1}),(0,e.jsx)("div",{className:"lock-item-ratio-label text-left ml-2"},u("includeAttribution")))))),h.modeType===p.Classic&&(0,e.jsx)(i.SettingRow,{className:"mt-2",flow:"wrap",role:"group","aria-label":u("selectEditableSettings"),label:u("selectEditableSettings")},(0,e.jsx)("div",{className:"w-100"},(0,e.jsx)("div",{title:u("printTitle"),className:"d-flex w-100 align-items-center check-box-con",onClick:()=>{je("enableMapSize")}},(0,e.jsx)(n.Checkbox,{title:u("printTitle"),className:"lock-item-ratio","data-field":"mapSize",checked:(null==O?void 0:O.enableMapSize)||!1}),(0,e.jsx)("div",{className:"lock-item-ratio-label text-left ml-2"},u("mapSize")))),(0,e.jsx)("div",{className:"w-100 mt-1"},(0,e.jsx)("div",{title:u("mapAttribution"),className:"d-flex w-100 align-items-center check-box-con",onClick:()=>{je("enableMapAttribution")}},(0,e.jsx)(n.Checkbox,{title:u("mapAttribution"),className:"lock-item-ratio","data-field":"mapSize",checked:(null==O?void 0:O.enableMapAttribution)||!1}),(0,e.jsx)("div",{className:"lock-item-ratio-label text-left ml-2"},u("mapAttribution")))))),!H(null==O?void 0:O.layout)&&(()=>{var t,o,r,l,s,a,c,d;return(0,e.jsx)(i.SettingSection,{title:u("LayoutOptions"),role:"group","aria-label":u("LayoutOptions")},(0,e.jsx)("div",{role:"group","aria-label":u("setDefaults")},(0,e.jsx)(i.SettingRow,{label:u("setDefaults"),flow:"wrap"}),(null==O?void 0:O.hasAuthorText)&&(0,e.jsx)(n.CollapsablePanel,{label:u("printTemplateAuthor"),isOpen:V===Kt.Author,onRequestOpen:()=>{Ce(Kt.Author)},onRequestClose:Re,role:"group","aria-label":u("printTemplateAuthor"),type:"primary",rightIcon:Zt,className:"mb-2"},(0,e.jsx)(i.SettingRow,{flow:"wrap",className:"mt-2"},(0,e.jsx)(n.TextInput,{size:"sm",className:"w-100",value:z,onAcceptValue:we,onChange:xe,"aria-label":u("printTemplateAuthor")}))),(null==O?void 0:O.hasCopyrightText)&&(0,e.jsx)(n.CollapsablePanel,{label:u("copyright"),isOpen:V===Kt.Copyright,onRequestOpen:()=>{Ce(Kt.Copyright)},onRequestClose:Re,role:"group","aria-label":u("copyright"),rightIcon:Zt,type:"primary",className:"mb-2"},(0,e.jsx)(i.SettingRow,{flow:"wrap",className:"mt-2"},(0,e.jsx)(n.TextInput,{size:"sm",className:"w-100",value:B,onAcceptValue:Se,onChange:Te,"aria-label":u("copyright")}))),(null==O?void 0:O.hasLegend)&&(0,e.jsx)(n.CollapsablePanel,{label:u("legend"),isOpen:V===Kt.Legend,onRequestOpen:()=>{Ce(Kt.Legend)},onRequestClose:Re,role:"group",type:"primary","aria-label":u("legend"),rightIcon:Zt,className:"mb-2"},(0,e.jsx)(i.SettingRow,{flow:"wrap",className:"mt-2"},(0,e.jsx)("div",{title:u("includeLegend"),className:"d-flex w-100 align-items-center check-box-con",onClick:Pe},(0,e.jsx)(n.Checkbox,{title:u("includeLegend"),className:"lock-item-ratio",checked:Me()}),(0,e.jsx)("div",{className:"lock-item-ratio-label text-left ml-2"},u("includeLegend"))))),(0,e.jsx)(n.CollapsablePanel,{label:u("scaleBarUnit"),isOpen:V===Kt.ScaleBarUnit,onRequestOpen:()=>{Ce(Kt.ScaleBarUnit)},onRequestClose:Re,role:"group","aria-label":u("scaleBarUnit"),rightIcon:Zt,type:"primary",className:V===Kt.ScaleBarUnit&&"active-collapse"},(0,e.jsx)(i.SettingRow,{flow:"wrap",className:"mt-2"},(0,e.jsx)(n.Select,{value:null===(t=null==O?void 0:O.layoutOptions)||void 0===t?void 0:t.scalebarUnit,onChange:ke,size:"sm","aria-label":u("scaleBarUnit")},function(e){return[{value:"Miles",label:e("unitsLabelMiles")},{value:"Kilometers",label:e("unitsLabelKilometers")},{value:"Meters",label:e("unitsLabelMeters")},{value:"Feet",label:e("unitsLabelFeet")}]}(u).map(((t,o)=>(0,e.jsx)(n.Option,{key:`unit${o}`,value:t.value,title:t.label},t.label)))))),(null===(r=null===(o=null==O?void 0:O.layoutOptions)||void 0===o?void 0:o.customTextElements)||void 0===r?void 0:r.length)>0&&(()=>{const t=[];return null==Q||Q.forEach(((o,r)=>{var l;for(const s in o){const a=(0,e.jsx)(n.CollapsablePanel,{label:s,key:`${s}_${r}`,isOpen:(null===(l=null==ee?void 0:ee[r])||void 0===l?void 0:l[s])||!1,onRequestOpen:()=>{De(s,r)},onRequestClose:Re,role:"group","aria-label":s,rightIcon:Zt,type:"primary",className:ee[s]&&"active-collapse"},(0,e.jsx)(i.SettingRow,{flow:"wrap",className:"align-item-center mt-2"},(0,e.jsx)(n.TextInput,{size:"sm",className:"flex-grow-1",value:o[s]||"","aria-label":s,onAcceptValue:e=>{Fe(r,s,e)},onChange:e=>{qe(r,s,e)}})));t.push(a)}})),t})(),ie&&(0,e.jsx)(n.CollapsablePanel,{label:u("northArrow"),isOpen:V===Kt.NorthArrow,onRequestOpen:()=>{Ce(Kt.NorthArrow)},onRequestClose:Re,role:"group",type:"primary","aria-label":u("northArrow"),rightIcon:Zt,className:"mb-2"},(0,e.jsx)(i.SettingRow,{flow:"wrap",className:"mt-2"},(0,e.jsx)("div",{title:u("includeNorthArrow"),className:"d-flex w-100 align-items-center check-box-con",onClick:He},(0,e.jsx)(n.Checkbox,{title:u("includeNorthArrow"),className:"lock-item-ratio",checked:null===(a=null===(s=null===(l=null==O?void 0:O.layoutOptions)||void 0===l?void 0:l.elementOverrides)||void 0===s?void 0:s[ie])||void 0===a?void 0:a.visible}),(0,e.jsx)("div",{className:"lock-item-ratio-label text-left ml-2"},u("includeNorthArrow")))))),h.modeType===p.Classic&&(0,e.jsx)(i.SettingRow,{className:"mt-2",flow:"wrap",role:"group","aria-label":u("selectEditableSettings"),label:u("selectEditableSettings")},(0,e.jsx)("div",{className:"w-100"},(null==O?void 0:O.hasAuthorText)&&(0,e.jsx)("div",{title:u("printTemplateAuthor"),className:"d-flex w-100 align-items-center check-box-con",onClick:()=>{je("enableAuthor")}},(0,e.jsx)(n.Checkbox,{title:u("printTemplateAuthor"),className:"lock-item-ratio",checked:(null==O?void 0:O.enableAuthor)||!1}),(0,e.jsx)("div",{className:"lock-item-ratio-label text-left ml-2"},u("printTemplateAuthor"))),(null==O?void 0:O.hasCopyrightText)&&(0,e.jsx)("div",{title:u("copyright"),className:"d-flex w-100 align-items-center check-box-con",onClick:()=>{je("enableCopyright")}},(0,e.jsx)(n.Checkbox,{title:u("copyright"),className:"lock-item-ratio",checked:(null==O?void 0:O.enableCopyright)||!1}),(0,e.jsx)("div",{className:"lock-item-ratio-label text-left ml-2"},u("copyright"))),(null==O?void 0:O.hasLegend)&&(0,e.jsx)("div",{title:u("legend"),className:"d-flex w-100 align-items-center check-box-con",onClick:()=>{je("enableLegend")}},(0,e.jsx)(n.Checkbox,{title:u("legend"),className:"lock-item-ratio",checked:(null==O?void 0:O.enableLegend)||!1}),(0,e.jsx)("div",{className:"lock-item-ratio-label text-left ml-2"},u("legend"))),(0,e.jsx)("div",{title:u("scaleBarUnit"),className:"d-flex w-100 align-items-center check-box-con",onClick:()=>{je("enableScalebarUnit")}},(0,e.jsx)(n.Checkbox,{title:u("scaleBarUnit"),className:"lock-item-ratio",checked:(null==O?void 0:O.enableScalebarUnit)||!1}),(0,e.jsx)("div",{className:"lock-item-ratio-label text-left ml-2"},u("scaleBarUnit"))),(null===(d=null===(c=null==O?void 0:O.layoutOptions)||void 0===c?void 0:c.customTextElements)||void 0===d?void 0:d.length)>0&&(()=>{const t=[];return null==Q||Q.forEach(((o,i)=>{var r,l;for(const s in o){const o=(0,e.jsx)("div",{key:`${s}_${i}`,title:s,className:"d-flex w-100 align-items-center check-box-con",onClick:()=>{Ge(s,i)}},(0,e.jsx)(n.Checkbox,{title:s,className:"lock-item-ratio",checked:(null===(l=null===(r=null==O?void 0:O.customTextElementEnableList)||void 0===r?void 0:r[i])||void 0===l?void 0:l[s])||!1}),(0,e.jsx)("div",{className:"lock-item-ratio-label text-left ml-2"},s));t.push(o)}})),t})(),ie&&(0,e.jsx)("div",{title:u("northArrow"),className:"d-flex w-100 align-items-center check-box-con",onClick:()=>{je("enableNorthArrow")}},(0,e.jsx)(n.Checkbox,{title:u("northArrow"),className:"lock-item-ratio",checked:(null==O?void 0:O.enableNorthArrow)||!1}),(0,e.jsx)("div",{className:"lock-item-ratio-label text-left ml-2"},u("northArrow"))))))})(),(0,e.jsx)(i.SettingSection,null,(0,e.jsx)(i.SettingRow,{className:"mb-4",label:u("overrideCommonSettings")},(0,e.jsx)(n.Switch,{"aria-label":u("overrideCommonSettings"),checked:(null==O?void 0:O.overrideCommonSetting)||!1,onChange:Ke})),(null==O?void 0:O.overrideCommonSetting)&&(0,e.jsx)(Ne,{id:c,printTemplateProperties:O,handleTemplatePropertyChange:Ee,modeType:null==h?void 0:h.modeType,jimuMapView:y}),(0,e.jsx)(n.AlertPopup,{isOpen:oe,toggle:Ve,hideHeader:!0,onClickOk:Ae,onClickClose:Ve,css:Ze},(0,e.jsx)("div",{className:"align-middle pt-2 remind-title d-flex align-items-center"},(0,e.jsx)("div",{className:"mr-1"},(0,e.jsx)(qt,{className:"align-middle",size:"l",color:"var(--warning-600)"})),(0,e.jsx)("span",{className:"align-middle flex-grow-1"},u("overrideSettingsTitle"))),(0,e.jsx)("div",{className:"remind-con"},u("overrideSettingsRemind")))))))};var Qt=v(71371),Yt=function(e,t,o,n){return new(o||(o=Promise))((function(i,r){function l(e){try{a(n.next(e))}catch(e){r(e)}}function s(e){try{a(n.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(l,s)}a((n=n.apply(e,t||[])).next())}))};const{useState:Xt,useEffect:eo,useRef:to}=e.React,oo=[e.SupportedUtilityType.Printing],no=t=>{const o=to(!1),r=e.hooks.useTranslation(T,n.defaultMessages),{config:l,id:s,onSettingChange:a,toggleLoading:u,toggleRemindPopper:c}=t,[d,p]=Xt(null==l?void 0:l.useUtility),m=e.css`
    &>div>div {
      padding-left: 0!important;
      padding-right: 0!important;
    }
    .utility-list {
      margin-bottom: 0 !important;
    }
  }`;eo((()=>{p(null==l?void 0:l.useUtility)}),[l]);const v=()=>{let e=l;e=e.set("useUtility",null),p(null),u(!1),a({id:s,config:e,useUtilities:[]})},h=t=>Yt(void 0,void 0,void 0,(function*(){u(!0),((e,t)=>S(void 0,void 0,void 0,(function*(){return B(e).then((o=>k(o,e,t)))})))(t,l).then((e=>{if(o.current)return!1;u(!1),a({id:s,config:e,useUtilities:t?[t]:[]})}),(o=>{!function(t,o,n){var i,r,l,s;const a=e.UtilityManager.getInstance().utilityHasSignInError(t);let u=404===(null===(i=null==n?void 0:n.details)||void 0===i?void 0:i.httpStatus);400===(null===(r=null==n?void 0:n.details)||void 0===r?void 0:r.httpStatus)&&(null===(s=null===(l=null==n?void 0:n.details)||void 0===l?void 0:l.message)||void 0===s?void 0:s.includes("Item does not exist"))&&(u=!0),a||u?(o&&o(!0),e.UtilityManager.getInstance().reportUtilityState(t,!1,a)):(o&&o(!1),e.UtilityManager.getInstance().reportUtilityState(t,!0))}(null==t?void 0:t.utilityId,null,o),v(),u(!1),c(!0)}))}));return(0,e.jsx)("div",{css:m},(0,e.jsx)(i.SettingRow,{flow:"wrap",label:r("printService"),role:"group","aria-label":r("printService")},(0,e.jsx)(Qt.UtilitySelector,{useUtilities:(t=>{var o;if(!t)return(0,e.Immutable)([]);const n=null===(o=(0,e.getAppStore)().getState().appStateInBuilder.appConfig)||void 0===o?void 0:o.utilities;if(null==n?void 0:n[t.utilityId])return(0,e.Immutable)([t]);(0,e.Immutable)([])})(d),onChange:e=>{const t=e[0];p(t),t?(o.current=!1,h(t)):(o.current=!0,v())},showRemove:!0,closePopupOnSelect:!0,types:oo})))};var io=function(e,t,o,n){return new(o||(o=Promise))((function(i,r){function l(e){try{a(n.next(e))}catch(e){r(e)}}function s(e){try{a(n.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(l,s)}a((n=n.apply(e,t||[])).next())}))};const{useState:ro,useRef:lo}=e.React,so=t=>{const o=lo(null),r=lo(null),{config:l,id:s,jimuMapView:a,showLoading:u,className:c,onSettingChange:d,handlePropertyChange:p,toggleRemindPopper:m,toggleLoading:v}=t,h=e.hooks.useTranslation(T,n.defaultMessages),f=e.css`
    .radio-con {
      cursor: pointer;
    }
    .loading-con {
      height: ${e.polished.rem(100)};
    }
  `,[y,b]=ro(null),[x,w]=ro(null),[S,I]=ro(!0),C=(e,t)=>{var n,i;if(e===y)b(null);else{const r=null===(i=null===(n=o.current)||void 0===n?void 0:n.getElementsByClassName("jimu-tree-item__body"))||void 0===i?void 0:i[t];b(e),r&&w(r)}},R=e=>{const t=F(null==l?void 0:l.printServiceType,null==l?void 0:l.printTemplateType);p(t?"printCustomTemplate":"printOrgTemplate",e)},k=()=>{I(!S)};return(0,e.jsx)(i.SettingSection,{className:c,css:f,role:"group","aria-label":h("configurePrintTemplate")},(0,e.jsx)(n.CollapsablePanel,{label:h("configurePrintTemplate"),isOpen:S,onRequestOpen:k,onRequestClose:k,"aria-label":h("configurePrintTemplate"),className:"custom-setting-collapse"},(0,e.jsx)(no,{id:s,config:l,showLoading:u,onSettingChange:d,toggleLoading:v,toggleRemindPopper:m}),u&&(0,e.jsx)("div",{className:"loading-con position-relative"},(0,e.jsx)(n.Loading,{type:n.LoadingType.Secondary,width:38,height:38})),(null==l?void 0:l.useUtility)&&!u&&(0,e.jsx)("div",null,(null==l?void 0:l.printTemplateType)===g.Customize&&(0,e.jsx)(n.Button,{className:"w-100 mt-2",ref:r,type:"primary",onClick:()=>io(void 0,void 0,void 0,(function*(){var e,t,o;let n=(null===(t=null===(e=null==l?void 0:l.printCustomTemplate)||void 0===e?void 0:e[0])||void 0===t?void 0:t.asMutable({deep:!0}))||{};const i=(null===(o=null==l?void 0:l.printCustomTemplate)||void 0===o?void 0:o.asMutable({deep:!0}))||[],s=le(i,null==l?void 0:l.printServiceType,g.Customize);n=yield O(l,n,s,h("untitledTemplate")),i.push(n),p("printCustomTemplate",i),w(r.current),b(s)}))},(0,e.jsx)(we,{className:"mr-1"}),h("newTemplate")),(0,e.jsx)("div",{ref:o},!u&&(0,e.jsx)(fe,{id:s,handelActiveTemplateIdChange:C,handelTemplateListChange:R,showNewTemplateItem:!1,activeTemplateId:y,config:l})),(0,e.jsx)(Jt,{id:s,isOpen:y,config:l,activeTemplateId:y,toggle:()=>{C(null)},handelTemplateListChange:R,jimuMapView:a,trigger:o.current,popperFocusNode:x,onSettingChange:d}))))};var ao=v(15562),uo=v(54337);const co=t=>{const o=(0,vt.getTheme2)(),r=e.hooks.useTranslation(T,n.defaultMessages),{config:s,handlePropertyChange:a}=t,u=e.css`
    .outline-con {
      input {
        width: ${e.polished.rem(55)};
      }
    }
    .preview-style-setting-con {
      margin-top: ${e.polished.rem(16)};
    }
    .enable-preview-label {
      margin-right: ${e.polished.rem(10)};
    }
  `,c=()=>{a("enablePreview",!(null==s?void 0:s.enablePreview))},d=e=>{0===e.length&&(e="rgba(0,216,237,1)"),a("previewBackgroundColor",e)},p=(t,o)=>{const n=null==o?void 0:o.includes("px"),i=function(e){const t=null==e?void 0:e.split("px")[0];return!(!e||!t)&&Number(t)>=0}(o);if(n&&!i)return;const r=(null==s?void 0:s.previewOutLine)||(0,e.Immutable)(l);0===o.length&&(o=l[t]),a("previewOutLine",r.setIn([t],o))};return(0,e.jsx)(i.SettingSection,{css:u,role:"group",title:(0,e.jsx)("div",{className:"d-flex align-items-center",onClick:c},(0,e.jsx)("div",{className:"flex-grow-1 enable-preview-label text-truncate w-100",title:r("showPrintArea")},r("showPrintArea")),(0,e.jsx)(n.Switch,{"aria-label":r("showPrintArea"),checked:null==s?void 0:s.enablePreview,onChange:c,title:r("showPrintArea")})),"aria-label":r("showPrintArea")},(null==s?void 0:s.enablePreview)&&(0,e.jsx)("div",{className:"preview-style-setting-con"},(0,e.jsx)(i.SettingRow,{label:r("fill"),"aria-label":r("fill")},(0,e.jsx)(uo.ThemeColorPicker,{value:null==s?void 0:s.previewBackgroundColor,specificTheme:o,onChange:d})),(0,e.jsx)(i.SettingRow,{className:"outline-con",flow:"no-wrap",label:r("columnOutline"),"aria-label":r("columnOutline")},(0,e.jsx)(ao.SizeColorSetting,{color:(null===(m=null==s?void 0:s.previewOutLine)||void 0===m?void 0:m.color)||l.color,size:(null===(v=null==s?void 0:s.previewOutLine)||void 0===v?void 0:v.size)||l.size,onChange:p}))));var m,v};var po=v(31027),mo=v.n(po),vo=function(e,t){var o={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(o[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(o[n[i]]=e[n[i]])}return o};const ho=t=>{const o=window.SVG,{className:n}=t,i=vo(t,["className"]),r=(0,e.classNames)("jimu-icon jimu-icon-component",n);return o?e.React.createElement(o,Object.assign({className:r,src:mo()},i)):e.React.createElement("svg",Object.assign({className:r},i))},go=()=>{const t=e.hooks.useTranslation(T,n.defaultMessages),o=e.css`
    & {
      & {
        color: var(--ref-palette-neutral-800);
      }
      p {
        color: var(--ref-palette-neutral-1000);
        font-size: ${e.polished.rem(14)};
        margin: ${e.polished.rem(16)} auto 0;
        line-height: ${e.polished.rem(19)};
        width: ${e.polished.rem(228)};
      }
    }
  `;return(0,e.jsx)("div",{className:"w-100 mt-4 text-center utility-placeholder",css:o},(0,e.jsx)("div",{className:"text-center w-100"},(0,e.jsx)(ho,{size:48}),(0,e.jsx)("p",{className:"text-Secondary",id:"list-empty-tip",title:t("utilityPlaceholder")},t("utilityPlaceholder"))))},{useEffect:fo,useRef:yo}=e.React,bo={width:"360px",height:"460px"},xo={width:"40px",height:"40px"},wo=r=>{const{config:l,id:s,portalUrl:a,onSettingChange:u,useMapWidgetIds:c}=r,d=e.hooks.useTranslation(T,n.defaultMessages),m=yo(null),h=e.ReactRedux.useSelector((e=>{var t,o;return null===(o=null===(t=null==e?void 0:e.appStateInBuilder)||void 0===t?void 0:t.widgetsState[s])||void 0===o?void 0:o.layoutInfo})),g=e.ReactRedux.useSelector((e=>e.appStateInBuilder.appConfig)),[f,y]=e.React.useState(null),[b,x]=e.React.useState(!1),[w,S]=e.React.useState(!1),[I,C]=e.React.useState(!1),R=e.css`
    & .custom-setting-collapse>div.collapse-header {
      padding-left: 0 !important;
      padding-right: 0 !important;
    }
    .no-utility-setting {
      border-bottom: none;
    }
    .select-mode-con {
      &>div {
        flex: 1;
      }
      button {
        height: ${e.polished.rem(80)};
        background: var(--ref-palette-neutral-300);
        border: 2px solid transparent;
        &:not(:disabled):not(.disabled).active {
          border-color: var(--sys-color-primary-main);
          background: var(--ref-palette-neutral-300);
        }
      }
      img {
        width: 100%;
        height: 100%;
        margin: 0 auto;
      }
    }
    .remind-con {
      top: ${e.polished.rem(90)};
    }
    .text-wrap {
      overflow: hidden;
      white-space: pre-wrap;
    }
    .setting-collapse {
      & {
        margin-bottom: ${e.polished.rem(8)};
      }
      .collapse-header {
        line-height: 2.2;
        padding-left: ${e.polished.rem(8)} !important;
        padding-right: ${e.polished.rem(8)} !important;
      }
      .handle{
        height: ${e.polished.rem(32)};
        background: var(--ref-palette-neutral-500);
        padding-left: ${e.polished.rem(8)};
        padding-right: ${e.polished.rem(8)};
      }
    }
  `,O=e.ReactRedux.useSelector((e=>e.appStateInBuilder.appConfig.utilities));fo((()=>{k(O)}),[O]),fo((()=>{j()}),[l]);const k=e.hooks.useEventCallback((e=>{var t,o;const n=null===(t=null==l?void 0:l.useUtility)||void 0===t?void 0:t.utilityId;if(!n)return;(null===(o=Object.keys(e||{}))||void 0===o?void 0:o.includes(n))||E("useUtility",null)})),j=()=>{var e,t;const n=null===(t=null===(e=null==g?void 0:g.widgets)||void 0===e?void 0:e[s])||void 0===t?void 0:t.style;if(!(null==l?void 0:l.hasInitBorder)&&!(null==n?void 0:n.border)){const e=(0,o.getAppConfigAction)(),t={color:"var(--light-800)",type:"solid",width:"1px"};let i;i=n?n.set("border",t):{border:t};const r=null==l?void 0:l.set("hasInitBorder",!0);e.editWidgetProperty(s,"style",i).editWidgetProperty(s,"config",r).exec()}},E=(e,t)=>{if((null==l?void 0:l[e])===t)return!1;const o=l.setIn([e],t);u({id:s,config:o})},N=(e=!1)=>{x(e),e&&(clearTimeout(m.current),m.current=setTimeout((()=>{x(!1)}),5e3))},A=t=>{var n;const i=l.setIn(["modeType"],t),r=(0,o.getAppConfigAction)();let a=bo;t===p.Compact&&(a=xo);if(P()===e.LayoutType.FixedLayout){const{layoutId:e,layoutItemId:t}=h,o=g.layouts[e],l=(null===(n=null==o?void 0:o.content)||void 0===n?void 0:n[t]).bbox.set("width",a.width).set("height",a.height);r.editLayoutItemProperty(h,"bbox",l).editWidgetProperty(s,"config",i).exec()}else r.editWidgetProperty(s,"config",i).exec()},P=()=>{var e,t;const o=null==h?void 0:h.layoutId;return null===(t=null===(e=null==g?void 0:g.layouts)||void 0===e?void 0:e[o])||void 0===t?void 0:t.type},M=()=>{S(!w)};return(0,e.jsx)("div",{className:"widget-setting-search jimu-widget-search",css:R},(0,e.jsx)(i.SettingSection,{className:"map-selector-section",role:"group","aria-label":d("printSource"),title:d("printSource")},(0,e.jsx)(i.SettingRow,{flow:"wrap",label:d("selectMap"),role:"group","aria-label":d("selectMap")},(0,e.jsx)(i.MapWidgetSelector,{onSelect:e=>{u({id:s,useMapWidgetIds:e})},"aria-label":d("selectMap"),useMapWidgetIds:c})),(0,e.jsx)("div",{className:"fly-map"},(0,e.jsx)("div",null,(0,e.jsx)(t.JimuMapViewComponent,{useMapWidgetId:null==c?void 0:c[0],onActiveViewChange:e=>{null==e||"3d"===e.view.type?y(null):(null==e?void 0:e.id)!==(null==f?void 0:f.id)&&y(e)}})))),(0,e.jsx)(i.SettingSection,{className:"map-selector-section"},(0,e.jsx)(i.SettingRow,{flow:"wrap",label:d("printMode"),role:"group","aria-label":d("printMode")},(0,e.jsx)("div",{className:"d-flex w-100 select-mode-con"},(0,e.jsx)("div",{className:"flex-grow-1 text-truncate"},(0,e.jsx)(n.Button,{className:"w-100",title:d("printClassic"),active:(null==l?void 0:l.modeType)===p.Classic,onClick:()=>{A(p.Classic)}},(0,e.jsx)(n.Icon,{autoFlip:!0,icon:v(3158)})),(0,e.jsx)("div",{className:"mt-2 w-100 text-center text-truncate",title:d("printClassic")},d("printClassic"))),(0,e.jsx)("div",{className:"flex-grow-1 ml-2 text-truncate"},(0,e.jsx)(n.Button,{className:"w-100",active:(null==l?void 0:l.modeType)===p.Compact,title:d("printCompact"),onClick:()=>{A(p.Compact)}},(0,e.jsx)(n.Icon,{autoFlip:!0,icon:v(15417)})),(0,e.jsx)("div",{className:"mt-2 text-center text-truncate",title:d("printCompact")},d("printCompact")))))),(0,e.jsx)("div",{className:"w-100 position-absolute remind-con"},(0,e.jsx)(n.Alert,{withIcon:!0,form:"basic",type:"warning",open:b,closable:!0,className:"w-100",text:d("serviceIsNotAvailable"),onClose:()=>{N(!1)}})),(0,e.jsx)(so,{id:s,config:l,portalUrl:a,handlePropertyChange:E,onSettingChange:u,jimuMapView:f,toggleRemindPopper:N,showLoading:I,toggleLoading:e=>{C(e)},className:!(null==l?void 0:l.useUtility)&&!I&&"no-utility-setting"}),(null==l?void 0:l.useUtility)&&(0,e.jsx)(i.SettingSection,{role:"group","aria-label":d("templateCommonSettings")},(0,e.jsx)(n.CollapsablePanel,{label:d("templateCommonSettings"),isOpen:w,onRequestOpen:M,onRequestClose:M,"aria-label":d("templateCommonSettings"),className:"custom-setting-collapse"},(0,e.jsx)(Ne,{id:s,printTemplateProperties:null==l?void 0:l.commonSetting,handleTemplatePropertyChange:e=>{const t=l.set("commonSetting",e);u({id:s,config:t})},modeType:null==l?void 0:l.modeType,jimuMapView:f}))),(null==l?void 0:l.useUtility)&&(0,e.jsx)(co,{config:l,handlePropertyChange:E}),!(null==l?void 0:l.useUtility)&&!I&&(0,e.jsx)(go,null))};function To(e){v.p=e}})(),h})())}}}));